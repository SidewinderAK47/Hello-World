<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="blog," />





  <link rel="alternate" href="/atom.xml" title="Sidewinder's Blog" type="application/atom+xml" />






<meta name="description" content="职称系统修改笔记2019年4月4日评审结果管理：添加全部删除当年度的所有评审结果功能 2019年4月4日 添加一个按钮，删除该年度所有的评审材料。（完成）已经修复了全部下面的一些小问题（全部、其他非选定年费，往下翻页会一直跳到2018年） 基本思路是 检查下是否选择的是年份，然后提交即可  在promotelist.jsp中添加1&amp;lt;s:submit value=&quot;删除年度材料&quot; align=">
<meta name="keywords" content="blog">
<meta property="og:type" content="article">
<meta property="og:title" content="职称系统修改笔记">
<meta property="og:url" content="http://yoursite.com/2019/04/05/修改笔记/index.html">
<meta property="og:site_name" content="Sidewinder&#39;s Blog">
<meta property="og:description" content="职称系统修改笔记2019年4月4日评审结果管理：添加全部删除当年度的所有评审结果功能 2019年4月4日 添加一个按钮，删除该年度所有的评审材料。（完成）已经修复了全部下面的一些小问题（全部、其他非选定年费，往下翻页会一直跳到2018年） 基本思路是 检查下是否选择的是年份，然后提交即可  在promotelist.jsp中添加1&amp;lt;s:submit value=&quot;删除年度材料&quot; align=">
<meta property="og:locale" content="default">
<meta property="og:image" content="http://yoursite.com/2019/04/05/修改笔记/images/日志1.png">
<meta property="og:updated_time" content="2019-04-05T05:09:47.812Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="职称系统修改笔记">
<meta name="twitter:description" content="职称系统修改笔记2019年4月4日评审结果管理：添加全部删除当年度的所有评审结果功能 2019年4月4日 添加一个按钮，删除该年度所有的评审材料。（完成）已经修复了全部下面的一些小问题（全部、其他非选定年费，往下翻页会一直跳到2018年） 基本思路是 检查下是否选择的是年份，然后提交即可  在promotelist.jsp中添加1&amp;lt;s:submit value=&quot;删除年度材料&quot; align=">
<meta name="twitter:image" content="http://yoursite.com/2019/04/05/修改笔记/images/日志1.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2019/04/05/修改笔记/"/>





  <title>职称系统修改笔记 | Sidewinder's Blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Sidewinder's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-schedule">
          <a href="/schedule/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-calendar"></i> <br />
            
            Schedule
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/05/修改笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Sidewinder_AK47">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sidewinder's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">职称系统修改笔记</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-04-05T13:08:59+08:00">
                2019-04-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Study-record/" itemprop="url" rel="index">
                    <span itemprop="name">Study record</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/04/05/修改笔记/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2019/04/05/修改笔记/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="职称系统修改笔记"><a href="#职称系统修改笔记" class="headerlink" title="职称系统修改笔记"></a>职称系统修改笔记</h1><h2 id="2019年4月4日"><a href="#2019年4月4日" class="headerlink" title="2019年4月4日"></a>2019年4月4日</h2><h3 id="评审结果管理：添加全部删除当年度的所有评审结果功能-2019年4月4日"><a href="#评审结果管理：添加全部删除当年度的所有评审结果功能-2019年4月4日" class="headerlink" title="评审结果管理：添加全部删除当年度的所有评审结果功能 2019年4月4日"></a>评审结果管理：添加全部删除当年度的所有评审结果功能 2019年4月4日</h3><ul>
<li>添加一个按钮，删除该年度所有的评审材料。（完成）<br>已经修复了全部下面的一些小问题（全部、其他非选定年费，往下翻页会一直跳到2018年）</li>
<li>基本思路是 检查下是否选择的是年份，然后提交即可<br></li>
</ul>
<p>在<em>promotelist.jsp</em>中添加<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;s:submit value="删除年度材料" align="left" style="width:100px;" cssClass="botton" method="deletePromotes" onclick="return deleteAllPromoteByYear();" &gt;&lt;/s:submit&gt;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deleteAllPromoteByYear</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> year=$(<span class="string">"#searchYear&gt;option:selected"</span>).val();</span><br><span class="line">    <span class="comment">//console.log(year);</span></span><br><span class="line">    <span class="comment">//console.log(len(year));</span></span><br><span class="line">    <span class="keyword">if</span>(year===<span class="literal">null</span>||year===<span class="literal">undefined</span>||year===<span class="string">''</span>)&#123;</span><br><span class="line">        alert(<span class="string">"请先选择评审年度!"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(confirm(<span class="string">"您确定要删除"</span>+year+<span class="string">"评审年度的所有评审结果吗？"</span>))&#123;</span><br><span class="line">            <span class="keyword">var</span> addr = <span class="string">"PromoteAction!deleteAllPromotesByApplyYearCommitID.action"</span>;</span><br><span class="line">            $(<span class="string">"#PromoteAction"</span>).attr(<span class="string">"action"</span>,addr);</span><br><span class="line">            $(<span class="string">"#PromoteAction"</span>).submit();</span><br><span class="line">        &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><em>/zcps-master/src/com/zcps/promote/action/PromoteAction.java</em> 中添加删除该年度，所有评审材料函数<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">deleteAllPromotesByApplyYearCommitID</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="comment">//前端已经做了年的检查，后端再次检查</span></span><br><span class="line">		<span class="comment">//manager = new PromoteManager();</span></span><br><span class="line">		<span class="comment">//materialManager = new AppMaterialManager();</span></span><br><span class="line">		<span class="comment">//commitInfoManager = new CommitInfoManager();</span></span><br><span class="line">		yearManager = <span class="keyword">new</span> AppYearManager();</span><br><span class="line">		AppYear year = yearManager.getActiveYear();</span><br><span class="line">		<span class="keyword">if</span>(<span class="keyword">this</span>.applyYear==<span class="keyword">null</span>||<span class="keyword">this</span>.applyYear.equals(<span class="string">""</span>))&#123;</span><br><span class="line">			<span class="keyword">if</span>(year!= <span class="keyword">null</span>)&#123;</span><br><span class="line">				<span class="keyword">this</span>.applyYear = year.getApplyYear();</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				Calendar cal = Calendar.getInstance(); </span><br><span class="line">				SimpleDateFormat formatter = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy"</span>); </span><br><span class="line">				<span class="keyword">this</span>.applyYear = formatter.format(cal.getTime());	</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		manager = <span class="keyword">new</span> PromoteManager();</span><br><span class="line">		manager.deleteByApplyYearCommitID(commId, applyYear);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"getpromotesbypg"</span>;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="2-修复了【评审结果管理】，查询年度翻页的问题-2019年4月4日"><a href="#2-修复了【评审结果管理】，查询年度翻页的问题-2019年4月4日" class="headerlink" title="2 修复了【评审结果管理】，查询年度翻页的问题  2019年4月4日"></a>2 修复了【评审结果管理】，查询年度翻页的问题  2019年4月4日</h3><p>问题描述：翻页失效<br><em>com.zcps.promote.action.PromoteAction</em><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">   <span class="comment">/*原始代码*/</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">getPromotesByPG</span><span class="params">()</span></span>&#123;</span><br><span class="line">	manager = <span class="keyword">new</span> PromoteManager();</span><br><span class="line">	materialManager = <span class="keyword">new</span> AppMaterialManager();</span><br><span class="line">	commitInfoManager = <span class="keyword">new</span> CommitInfoManager();</span><br><span class="line">	yearManager = <span class="keyword">new</span> AppYearManager();</span><br><span class="line">       appyeardao = <span class="keyword">new</span> AppYearDAO();</span><br><span class="line">       appYearList = appyeardao.getAppYearList();</span><br><span class="line">	String commitCode = commitInfoManager.getCommit(commId).getCommCode();</span><br><span class="line">	</span><br><span class="line">	AppYear year = yearManager.getActiveYear();</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>(<span class="keyword">this</span>.applyYear == <span class="keyword">null</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>(year != <span class="keyword">null</span>)&#123;</span><br><span class="line">			<span class="keyword">this</span>.applyYear = year.getApplyYear();</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			Calendar cal = Calendar.getInstance(); </span><br><span class="line">			SimpleDateFormat formatter = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy"</span>); </span><br><span class="line">			<span class="keyword">this</span>.applyYear = formatter.format(cal.getTime());	</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">this</span>.pageURL = <span class="string">"PromoteAction!getPromotesByPG.action?orderby="</span> + <span class="keyword">this</span>.orderby + <span class="string">"&amp;"</span>;</span><br><span class="line">	promoteList = manager.getPromotesByYear(commId, applyYear, pageNumber, showItemNumber, orderby, sort);</span><br><span class="line">	pagebuffer = PageNumber.printPageNumber(pageNumber,showItemNumber,manager.getCountByYear(commId, applyYear), pageURL);</span><br><span class="line">	<span class="keyword">return</span> <span class="string">"getpromotesbypg"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*修改后代码*/</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getPromotesByPG</span><span class="params">()</span></span>&#123;</span><br><span class="line">    manager = <span class="keyword">new</span> PromoteManager();</span><br><span class="line">    materialManager = <span class="keyword">new</span> AppMaterialManager();</span><br><span class="line">    commitInfoManager = <span class="keyword">new</span> CommitInfoManager();</span><br><span class="line">    yearManager = <span class="keyword">new</span> AppYearManager();</span><br><span class="line">    appyeardao = <span class="keyword">new</span> AppYearDAO();</span><br><span class="line">    </span><br><span class="line">    appYearList = appyeardao.getAppYearList();</span><br><span class="line">    String commitCode = commitInfoManager.getCommit(commId).getCommCode();</span><br><span class="line">    </span><br><span class="line">    AppYear year = yearManager.getActiveYear();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">this</span>.applyYear==<span class="keyword">null</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(year != <span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">this</span>.applyYear = year.getApplyYear();</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            Calendar cal = Calendar.getInstance(); </span><br><span class="line">            SimpleDateFormat formatter = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy"</span>); </span><br><span class="line">            <span class="keyword">this</span>.applyYear = formatter.format(cal.getTime());	</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">this</span>.pageURL = <span class="string">"PromoteAction!getPromotesByPG.action?orderby="</span> + <span class="keyword">this</span>.orderby + <span class="string">"&amp;applyYear="</span>+<span class="keyword">this</span>.applyYear+<span class="string">"&amp;"</span>;</span><br><span class="line">    promoteList = manager.getPromotesByYear(commId, applyYear, pageNumber, showItemNumber, orderby, sort);</span><br><span class="line">    pagebuffer = PageNumber.printPageNumber(pageNumber,showItemNumber,manager.getCountByYear(commId, applyYear), pageURL);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"getpromotesbypg"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>主要修改了<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//主要修改了</span></span><br><span class="line"><span class="keyword">this</span>.pageURL = <span class="string">"PromoteAction!getPromotesByPG.action?orderby="</span> + <span class="keyword">this</span>.orderby + <span class="string">"&amp;applyYear="</span>+<span class="keyword">this</span>.applyYear+<span class="string">"&amp;"</span>;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="【评议组设置】存在的问题—2019年4月4日"><a href="#【评议组设置】存在的问题—2019年4月4日" class="headerlink" title="【评议组设置】存在的问题—2019年4月4日"></a>【评议组设置】存在的问题—2019年4月4日</h3><ul>
<li>评议组设置-没设置  里面，找不到没有设置过评议组的</li>
<li>修改了com.zcps.material.dao.AppMaterialViewDAO的一个函数中的queryString语句<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*原始结构*/</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List <span class="title">findMaterialsAlreadySetGroup</span><span class="params">(String commitCode, String applyYear, <span class="keyword">int</span> pageNumber, <span class="keyword">int</span> showItemNumber, String orderby, String sort)</span></span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        getSession().clear();</span><br><span class="line">        String queryString = <span class="string">"from AppMaterialView as material where material.applyCommit=? and material.applyYear=? and "</span> +</span><br><span class="line">                <span class="string">" material.applyGroup!=null order by material.applyGroup,material."</span> + orderby + sort;</span><br><span class="line">        <span class="comment">/*修改了queryString*/</span></span><br><span class="line">        Query queryObject = getSession().createQuery(queryString);</span><br><span class="line">        queryObject.setParameter(<span class="number">0</span>, commitCode);</span><br><span class="line">        queryObject.setParameter(<span class="number">1</span>, applyYear);</span><br><span class="line">        <span class="keyword">int</span> firstItem = (pageNumber-<span class="number">1</span>) * showItemNumber;</span><br><span class="line">        queryObject.setFirstResult(firstItem);</span><br><span class="line">        queryObject.setMaxResults(showItemNumber);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> queryObject.list();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (RuntimeException re) &#123;</span><br><span class="line">        log.error(<span class="string">"find AppMaterialView instance failed"</span>, re);</span><br><span class="line">        <span class="keyword">throw</span> re;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*修改后*/</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List <span class="title">findMaterialsAlreadySetGroup</span><span class="params">(String commitCode, String applyYear, <span class="keyword">int</span> pageNumber, <span class="keyword">int</span> showItemNumber, String orderby, String sort)</span></span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        getSession().clear();</span><br><span class="line">        String queryString = <span class="string">"from AppMaterialView as material where material.applyCommit=? and material.applyYear=? and "</span> +</span><br><span class="line">                <span class="string">" material.applyGroup!=null order by material."</span> + orderby + sort;</span><br><span class="line">        Query queryObject = getSession().createQuery(queryString);</span><br><span class="line">        queryObject.setParameter(<span class="number">0</span>, commitCode);</span><br><span class="line">        queryObject.setParameter(<span class="number">1</span>, applyYear);</span><br><span class="line">        <span class="keyword">int</span> firstItem = (pageNumber-<span class="number">1</span>) * showItemNumber;</span><br><span class="line">        queryObject.setFirstResult(firstItem);</span><br><span class="line">        queryObject.setMaxResults(showItemNumber);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> queryObject.list();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (RuntimeException re) &#123;</span><br><span class="line">        log.error(<span class="string">"find AppMaterialView instance failed"</span>, re);</span><br><span class="line">        <span class="keyword">throw</span> re;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>主要修改了<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//主要修改了</span></span><br><span class="line"> String queryString = <span class="string">"from AppMaterialView as material where material.applyCommit=? and material.applyYear=? and "</span> +</span><br><span class="line">                <span class="string">" material.applyGroup!=null order by material."</span> + orderby + sort;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="修改生成许可代码的代码-2019年4月4日19-24-18"><a href="#修改生成许可代码的代码-2019年4月4日19-24-18" class="headerlink" title="修改生成许可代码的代码 2019年4月4日19:24:18"></a>修改生成许可代码的代码 2019年4月4日19:24:18</h3><p>问题描述：许可码：0与O，1 与O I ,l   易混淆的<br>验证码范围是：大写字母+数字。<br><br>因为小写的L“l”不会出现，<br><br>易混淆的只有0和O<br><br>1和以及 大写的i “I”出现混淆 <br><br>则把这几个字母删除了，那么就不会有这种问题了。<br><br><em>com.zcps.system.tools.GenerateIden</em><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*修改后*/</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">generate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    StringBuffer buf = <span class="keyword">new</span> StringBuffer(<span class="string">"A,B,C,D,E,F,G,H,K,L,M,N,P,Q,R,S,T,U,V,W,X,Y,Z"</span>);<span class="comment">//26-3=23</span></span><br><span class="line">    buf.append(<span class="string">",2,3,4,5,6,7,8,9"</span>);<span class="comment">//10-2=8</span></span><br><span class="line"></span><br><span class="line">    String[] arr = buf.toString().split(<span class="string">","</span>);</span><br><span class="line">    </span><br><span class="line">    StringBuffer b = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">    Random r;</span><br><span class="line">    <span class="keyword">int</span> k ;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">6</span>;i++)&#123;</span><br><span class="line">            r = <span class="keyword">new</span> Random();</span><br><span class="line">            k = r.nextInt();</span><br><span class="line">            b.append(String.valueOf(arr[Math.abs(k % <span class="number">31</span>)]));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> b.toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>实现方式：之前验证码就没有设置小写字母，因此小写字母暂时没有考虑，就23个字母+8个数字变化。去掉易混淆的字母O,I,L与数字0,1</p>
</blockquote>
<h3 id="申报资料审核-未通过材料-修改到-未审材料"><a href="#申报资料审核-未通过材料-修改到-未审材料" class="headerlink" title="申报资料审核  未通过材料 修改到   未审材料"></a>申报资料审核  未通过材料 修改到   未审材料</h3><ul>
<li>需求：将已经审核的材料进行重新审核。</li>
<li>在 /zcps-master/WebRoot/appmaterialschecknotpass.jsp 添加一下代码<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;s:submit value="重新审核" align="left" cssClass="botton" onclick="setCheckResult('init')"&gt;&lt;/s:submit&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setCheckResult</span>(<span class="params">result</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> isSelected = checkNum(<span class="string">"applyIds"</span>);</span><br><span class="line">    <span class="keyword">if</span>(isSelected == <span class="literal">true</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(result == <span class="string">"pass"</span>)&#123;<span class="comment">//审核通过</span></span><br><span class="line">            $(<span class="string">"#submitform"</span>).attr(<span class="string">"action"</span>,<span class="string">"QualiCheckAction!setCheckPass.action"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(result == <span class="string">"init"</span>)&#123;<span class="comment">//加入未审核材料</span></span><br><span class="line">            <span class="comment">//var ckResultInputValue=</span></span><br><span class="line">            <span class="built_in">document</span>.getElementsByName(<span class="string">"ckResult"</span>)[<span class="number">0</span>].value=<span class="string">"未审核"</span>;</span><br><span class="line">            $(<span class="string">"#submitform"</span>).attr(<span class="string">"action"</span>,<span class="string">"QualiCheckAction!setCheckPass.action"</span>);</span><br><span class="line">            <span class="comment">// $("#submitform").attr("action","QualiCheckAction!setInitCheck.action");</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(result == <span class="string">"addPromote"</span>)&#123;</span><br><span class="line">            $(<span class="string">"#submitform"</span>).attr(<span class="string">"action"</span>,<span class="string">"QualiCheckAction!addPromote.action"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        $(<span class="string">"#submitform"</span>).submit();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>实现方式：原来已经有api的，没提交一次页面会刷新。<br>因此，实现【重新审核】最简单的方式就是前端修改隐藏表单。</p>
</blockquote>
<h3 id="投票页面的修改-【大修改】-2019年4月4日"><a href="#投票页面的修改-【大修改】-2019年4月4日" class="headerlink" title="投票页面的修改 【大修改】 2019年4月4日"></a>投票页面的修改 【大修改】 2019年4月4日</h3><ul>
<li>需求分析：查询时间过长。<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> <span class="keyword">import</span>=<span class="string">"java.util.*,com.zcps.system.configs.*, com.zcps.group.dao.GroupResult, </span></span><br><span class="line"><span class="string">	com.zcps.info.manager.*, com.zcps.commit.dao.*, com.zcps.commit.manager.*,com.zcps.group.manager.*"</span> pageEncoding=<span class="string">"GBK"</span>%&gt;</span><br><span class="line">&lt;%@ taglib uri=<span class="string">"/struts-tags"</span>  prefix=<span class="string">"s"</span> %&gt;</span><br><span class="line">&lt;%</span><br><span class="line">	String path = request.getContextPath();</span><br><span class="line">	String basePath = request.getScheme()+<span class="string">"://"</span>+request.getServerName()+<span class="string">":"</span>+request.getServerPort()+path+<span class="string">"/"</span>;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;%</span><br><span class="line">	session = request.getSession(<span class="keyword">true</span>);</span><br><span class="line">	String confer = (String)session.getAttribute(<span class="string">"confer"</span>);</span><br><span class="line">	String idenCode = (String)session.getAttribute(<span class="string">"idenCode"</span>);</span><br><span class="line">	Integer conferId = (Integer)session.getAttribute(<span class="string">"conferId"</span>);</span><br><span class="line">	request.setAttribute(<span class="string">"idenCode"</span>, idenCode);</span><br><span class="line">	request.setAttribute(<span class="string">"conferId"</span>, conferId);</span><br><span class="line">	</span><br><span class="line">	CommitConferManager conferManager = <span class="keyword">new</span> CommitConferManager();</span><br><span class="line">	<span class="keyword">int</span> round = conferManager.getConferRound(conferId);</span><br><span class="line">	request.setAttribute(<span class="string">"round"</span>, round);</span><br><span class="line">	CommitStatsManager statsManager = <span class="keyword">new</span> CommitStatsManager();</span><br><span class="line">	<span class="keyword">boolean</span> isAlreadyVote = statsManager.isAlreadyVote(idenCode, conferId, round);</span><br><span class="line">	</span><br><span class="line">	String commitName = <span class="string">""</span>;</span><br><span class="line">	String conferName = <span class="string">""</span>;</span><br><span class="line">	CommitConferManager manager = <span class="keyword">new</span> CommitConferManager();</span><br><span class="line">	CommitInfoManager infoManager = <span class="keyword">new</span> CommitInfoManager();</span><br><span class="line">	CommitConfer commitConfer = manager.getConferById(conferId);</span><br><span class="line">	conferName = commitConfer.getConferName();</span><br><span class="line">	commitName = infoManager.getCommit(commitConfer.getCommId()).getCommName();	</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">boolean</span> canVote = <span class="keyword">false</span>;</span><br><span class="line">	<span class="keyword">boolean</span> al = <span class="keyword">true</span>;</span><br><span class="line">	<span class="keyword">if</span>(commitConfer.getConferStatus().equals(Status.CONFER_VOTE_BEGGIN.getStatus()))&#123;</span><br><span class="line">		canVote = <span class="keyword">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(commitConfer.getConferStatus().equals(Status.CONFER_BEGIN.getStatus()))&#123;</span><br><span class="line">		al= <span class="keyword">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//如果专家已经提交过，则要得到该专家的投票信息</span></span><br><span class="line">	<span class="keyword">int</span> agreeNumber = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> disAgreeNumber = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> abondonNumber = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span>(isAlreadyVote)&#123;</span><br><span class="line">		agreeNumber = statsManager.getAgreeCount(conferId, idenCode, round);</span><br><span class="line">		disAgreeNumber = statsManager.getDisAgreeCount(conferId, idenCode, round);</span><br><span class="line">		abondonNumber = statsManager.getAbondonCount(conferId, idenCode, round);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> defaultAgree;</span><br><span class="line">	<span class="keyword">if</span>(<span class="keyword">null</span> != conferManager.getConferById(conferId).getCommTarget())</span><br><span class="line">		defaultAgree = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		defaultAgree = <span class="number">1</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> maxAgree = <span class="number">10000</span>;</span><br><span class="line">	<span class="keyword">if</span>(<span class="keyword">null</span> != commitConfer.getCommTarget())&#123;</span><br><span class="line">		maxAgree = commitConfer.getCommTarget();</span><br><span class="line">	&#125;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;!DOCTYPE html PUBLIC <span class="string">"-//W3C//DTD XHTML 1.0 Transitional//EN"</span>&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=gbk"</span> /&gt;</span><br><span class="line">&lt;title&gt;all of the materials&lt;/title&gt;</span><br><span class="line">&lt;link href=<span class="string">"css/public.css"</span> rel=<span class="string">"stylesheet"</span> type=<span class="string">"text/css"</span> /&gt;</span><br><span class="line">&lt;link href=<span class="string">"css/main.css"</span> rel=<span class="string">"stylesheet"</span> type=<span class="string">"text/css"</span> /&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line"></span><br><span class="line"> th&#123;</span><br><span class="line"> 	font-size: <span class="number">15</span>px;</span><br><span class="line"> 	margin: <span class="number">0</span>px;</span><br><span class="line"> 	padding: <span class="number">0</span>px;</span><br><span class="line"> &#125;</span><br><span class="line"> td&#123;</span><br><span class="line"> 	font-size: <span class="number">15</span>px;</span><br><span class="line"> 	text-align: center;</span><br><span class="line"> &#125;</span><br><span class="line"> span&#123;</span><br><span class="line">	display:inline-table;</span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line"> .spinner &#123;</span><br><span class="line">    width:<span class="number">300</span>px;</span><br><span class="line">     height:<span class="number">200</span>px;</span><br><span class="line">    position:absolute; </span><br><span class="line">    left:<span class="number">55</span>%; top:<span class="number">50</span>%; </span><br><span class="line">    margin:-<span class="number">100</span>px <span class="number">0</span> <span class="number">0</span> -<span class="number">150</span>px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> .spinner img&#123;</span><br><span class="line">  position:relitive;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line">#topline &#123;</span><br><span class="line">	background-image: url(./images/titlefieldvote2.png);</span><br><span class="line">	height: <span class="number">28</span>px;</span><br><span class="line">	width: <span class="number">220</span>px;</span><br><span class="line">	text-indent: <span class="number">35</span>px;</span><br><span class="line">	vertical-align: baseline;</span><br><span class="line">	padding-top: <span class="number">10</span>px;</span><br><span class="line">	top: <span class="number">20</span>px;</span><br><span class="line">	left:<span class="number">2</span>px;</span><br><span class="line">	font-size: <span class="number">13</span>px;</span><br><span class="line">	position: absolute;</span><br><span class="line">    &#125;</span><br><span class="line">    #maintitlecommit &#123;</span><br><span class="line">	background-image: url(./images/titlefieldvote1.png);</span><br><span class="line">	height: <span class="number">15</span>px;</span><br><span class="line">	width: <span class="number">1500</span>px;</span><br><span class="line">	margin-right: <span class="number">10</span>px;</span><br><span class="line">	margin-left: <span class="number">2</span>px;</span><br><span class="line">	text-indent: <span class="number">35</span>px;</span><br><span class="line">	vertical-align: baseline;</span><br><span class="line">	padding-top: <span class="number">6</span>px;</span><br><span class="line">	z-index: <span class="number">3</span>;</span><br><span class="line">	top: <span class="number">2</span>px;</span><br><span class="line">	font-size: <span class="number">13</span>px;</span><br><span class="line">	position: absolute;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;script src="js/jquery-1.6.2.min.js"&gt;&lt;/script&gt;</span><br><span class="line">&lt;script type='text/javascript' src='js/jquery.messager.js'&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src="js/jquery.cookie.js"&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src="js/checkbox.js" type="text/javascript"&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src="js/map.js" type="text/javascript"&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src="js/client.js"&gt;&lt;/script&gt;</span><br><span class="line">&lt;script type='text/javascript' src='&lt;%=basePath%&gt;dwr/engine.js'&gt;&lt;/script&gt;</span><br><span class="line">&lt;script type='text/javascript' src='&lt;%=basePath%&gt;dwr/interface/Remote.js'&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script type="text/javascript" src="js/display2.js"&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;script type=<span class="string">"text/javascript"</span>&gt;</span><br><span class="line"></span><br><span class="line">	var oPopup;</span><br><span class="line">	var popTop;</span><br><span class="line">	<span class="function">function <span class="title">popmsg</span><span class="params">(msgstr)</span></span>&#123;</span><br><span class="line">		oPopup = window.createPopup();</span><br><span class="line">		popTop=<span class="number">25</span></span><br><span class="line">		var winstr=<span class="string">""</span>;</span><br><span class="line">		</span><br><span class="line">		winstr+=<span class="string">""</span>;</span><br><span class="line">		winstr+=<span class="string">"&lt;h2 style=\"background:#87CEFA;font-size:12px; margin:0;\"&gt;专家提醒&lt;/h2&gt;"</span>;</span><br><span class="line">		winstr+=<span class="string">"&lt;h2 style=\"text-align:center; color:red;font-size:12px;border:0px; border-color:white;line-height:20px;width:auto;height:200px;margin:0;padding:40px 10px 10px 10px;background:#F5F5F5;\"&gt;"</span>+msgstr+<span class="string">"&lt;/h2&gt;"</span></span><br><span class="line">		</span><br><span class="line">		oPopup.document.body.innerHTML = winstr;</span><br><span class="line">		popshow();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function">function <span class="title">popshow</span><span class="params">()</span></span>&#123;</span><br><span class="line">		window.status=popTop;</span><br><span class="line">		<span class="keyword">if</span>(popTop&gt;<span class="number">860</span>)&#123;</span><br><span class="line">			clearTimeout(mytime);</span><br><span class="line">			oPopup.hide();</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span> <span class="keyword">if</span>(popTop&gt;<span class="number">760</span>&amp;&amp;popTop&lt;<span class="number">860</span>)&#123;</span><br><span class="line">			oPopup.show(screen.width-<span class="number">250</span>,screen.height,<span class="number">241</span>, <span class="number">860</span>-popTop);</span><br><span class="line">		&#125;<span class="keyword">else</span> <span class="keyword">if</span>(popTop&lt;<span class="number">90</span>)&#123;</span><br><span class="line">			oPopup.show(screen.width-<span class="number">250</span>,screen.height,<span class="number">241</span>, popTop);</span><br><span class="line">		&#125;<span class="keyword">else</span> <span class="keyword">if</span>(popTop&lt;<span class="number">110</span>)&#123;</span><br><span class="line">			oPopup.show(screen.width-<span class="number">250</span>,screen.height-popTop,<span class="number">241</span>, popTop);</span><br><span class="line">		&#125;</span><br><span class="line">		popTop+=<span class="number">5</span>;</span><br><span class="line">		var mytime=setTimeout(<span class="string">"popshow();"</span>,<span class="number">50</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	var resultMap;</span><br><span class="line">	var maxAgree = &lt;%=maxAgree%&gt;;</span><br><span class="line">	<span class="keyword">if</span>(maxAgree == <span class="number">0</span>)</span><br><span class="line">		maxAgree = <span class="number">10000</span>;</span><br><span class="line">	<span class="function">function <span class="title">saveResult</span><span class="params">(applyId, result, index)</span></span>&#123;</span><br><span class="line">		var max = <span class="keyword">false</span>;</span><br><span class="line">		<span class="keyword">if</span>(result == <span class="string">"agree"</span>)&#123;	<span class="comment">//首先检查同意人数是否达到了上限</span></span><br><span class="line">			<span class="keyword">if</span>(resultMap.getNum(result) &gt;= maxAgree)&#123;</span><br><span class="line">				var warning = <span class="string">"同意人数不能超过"</span> + maxAgree + <span class="string">"名!"</span>;</span><br><span class="line">				alert(warning);</span><br><span class="line">				var result = <span class="string">"abondon"</span>;</span><br><span class="line">				<span class="keyword">if</span>(resultMap.containsKey(applyId))&#123;</span><br><span class="line">					result = resultMap.get(applyId);</span><br><span class="line">				&#125;</span><br><span class="line">				var radio = document.getElementsByName(<span class="string">"radio"</span> + index);</span><br><span class="line">				<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;radio.length; i++)&#123;</span><br><span class="line">					radio[i].checked = <span class="keyword">false</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span>(result == <span class="string">"disagree"</span>)&#123;</span><br><span class="line">					radio[<span class="number">1</span>].checked = <span class="keyword">true</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span></span><br><span class="line">					radio[<span class="number">2</span>].checked = <span class="keyword">true</span>;</span><br><span class="line">				max = <span class="keyword">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(!max)&#123;</span><br><span class="line">			<span class="keyword">if</span>(resultMap.containsKey(applyId))&#123;</span><br><span class="line">				resultMap.remove(applyId);</span><br><span class="line">				resultMap.put(applyId, result);</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				resultMap.put(applyId, result);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		var appLength = document.getElementById(<span class="string">"listLength"</span>).value;</span><br><span class="line">		var agreeNum = resultMap.getNum(<span class="string">"agree"</span>) + <span class="string">""</span>;</span><br><span class="line">		var disagreeNum = resultMap.getNum(<span class="string">"disagree"</span>);</span><br><span class="line">		var abondonNum = resultMap.getNum(<span class="string">"abondon"</span>);</span><br><span class="line">		var surplus = maxAgree - agreeNum;</span><br><span class="line">		var remain = appLength - agreeNum - disagreeNum - abondonNum;</span><br><span class="line">		var content = <span class="string">"您的投票结果为：同意"</span> + agreeNum + <span class="string">"票，不同意"</span> + disagreeNum + <span class="string">"票，弃权"</span> + abondonNum + <span class="string">"票！"</span>;</span><br><span class="line">		document.getElementById(<span class="string">"js"</span>).innerHTML = content;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function">function <span class="title">checkAllSubmit</span><span class="params">()</span></span>&#123;</span><br><span class="line">		</span><br><span class="line">		var appLength = document.getElementById(<span class="string">"listLength"</span>).value;</span><br><span class="line">		var surplus = appLength-resultMap.size();</span><br><span class="line">		<span class="comment">//alert(1);</span></span><br><span class="line">		<span class="keyword">if</span>(surplus &gt; <span class="number">0</span>)&#123;</span><br><span class="line">			alert(<span class="string">"您还有"</span> + surplus + <span class="string">"个申请人没有进行投票！"</span>);</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span> <span class="keyword">if</span>(surplus == <span class="number">0</span>)&#123;</span><br><span class="line">			var resultStr = resultMap.getString();</span><br><span class="line">			document.getElementById(<span class="string">"result"</span>).value = resultStr;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		var agreeNum = resultMap.getNum(<span class="string">"agree"</span>);</span><br><span class="line">		var disagreeNum = resultMap.getNum(<span class="string">"disagree"</span>);</span><br><span class="line">		var abondonNum = resultMap.getNum(<span class="string">"abondon"</span>);</span><br><span class="line">		var note = <span class="string">'您的投票结果为：同意'</span>+ agreeNum +<span class="string">'票，不同意'</span>+ disagreeNum +<span class="string">'票，弃权'</span>+ abondonNum +<span class="string">'票!\n'</span>;</span><br><span class="line">		</span><br><span class="line">		var c = confirm(note+<span class="string">'确定要提交吗？'</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(c == <span class="keyword">false</span>)&#123;</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//$('#btnSubmit').attr('disabled','disabled');</span></span><br><span class="line">			<span class="comment">//alert(resultStr);</span></span><br><span class="line">			<span class="comment">//btnSubmit = $('#btnSubmit');</span></span><br><span class="line">			<span class="comment">//btnSubmit.attr("disabled",false);</span></span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		setTimeout(function()&#123;$(<span class="string">'#btnSubmit'</span>).attr(<span class="string">'disabled'</span>,<span class="string">'disabled'</span>);&#125;,<span class="number">0</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function">function <span class="title">preventCheck</span><span class="params">()</span></span>&#123;	<span class="comment">//已经提交过，不允许再点击</span></span><br><span class="line">		alert(<span class="string">"您已经投过票了，不允许再投！"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function">function <span class="title">printCheck</span><span class="params">()</span></span>&#123;		<span class="comment">//提交之前先打印</span></span><br><span class="line">		window.open(<span class="string">"CommitStatsAction!print.action?idenCode=&lt;%=idenCode%&gt;&amp;commConId=&lt;%=conferId%&gt;"</span>, <span class="string">"_blank"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function">function <span class="title">showMessage</span><span class="params">(msg)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">	    <span class="comment">//alert(msg);</span></span><br><span class="line">		var conferId = &lt;%=conferId%&gt;;</span><br><span class="line">		<span class="comment">//popmsg2(msg);</span></span><br><span class="line">		<span class="keyword">if</span>(conferId == msg)&#123;</span><br><span class="line">			popmsg(<span class="string">"刷新后可以开始投票！"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function">function <span class="title">setInitResult</span><span class="params">()</span></span>&#123;</span><br><span class="line">	    </span><br><span class="line">		dwr.engine.setActiveReverseAjax(<span class="keyword">true</span>);</span><br><span class="line">		resultMap = <span class="keyword">new</span> Map();</span><br><span class="line">		<span class="comment">//alert(resultMap);</span></span><br><span class="line">		var appLength = document.getElementById(<span class="string">"listLength"</span>).value;</span><br><span class="line">		<span class="keyword">for</span>(var i=<span class="number">0</span>; i&lt;appLength; i++)&#123;</span><br><span class="line">			</span><br><span class="line">			var applyIdFlag = <span class="string">"applyId"</span> + i;</span><br><span class="line">			var curApplyId = document.getElementById(applyIdFlag).value;</span><br><span class="line">			<span class="comment">//resultMap.clear();</span></span><br><span class="line">			</span><br><span class="line">			var defaultAgree = &lt;%=defaultAgree%&gt;;</span><br><span class="line">			<span class="keyword">if</span>(defaultAgree == <span class="number">1</span>)</span><br><span class="line">				resultMap.put(curApplyId, <span class="string">"agree"</span>);</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				resultMap.put(curApplyId, <span class="string">"abondon"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		var appLength = document.getElementById(<span class="string">"listLength"</span>).value;</span><br><span class="line">		var agreeNum = resultMap.getNum(<span class="string">"agree"</span>) + <span class="string">""</span>;</span><br><span class="line">		var disagreeNum = resultMap.getNum(<span class="string">"disagree"</span>);</span><br><span class="line">		var abondonNum = resultMap.getNum(<span class="string">"abondon"</span>);</span><br><span class="line">		var content = <span class="string">"您的投票结果为：同意"</span> + agreeNum + <span class="string">"票，不同意"</span> + disagreeNum + <span class="string">"票，弃权"</span> + abondonNum + <span class="string">"票！"</span>;</span><br><span class="line">		document.getElementById( <span class="string">"js"</span>).innerHTML = content;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//默认全部都投同意票</span></span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	<span class="function">function <span class="title">setHeight</span><span class="params">()</span></span>&#123;</span><br><span class="line">		var h = $(document).height();</span><br><span class="line">		$(<span class="string">'#showMate'</span>).css(<span class="string">'max-height'</span>, h-<span class="number">90</span>);</span><br><span class="line">		$(<span class="string">'#mainbox'</span>).css(<span class="string">'max-height'</span>, h);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function">function <span class="title">sendMessage</span><span class="params">()</span></span>&#123;</span><br><span class="line">		$.ajax(&#123;</span><br><span class="line">		    url : <span class="string">"Message.jsp"</span>,<span class="comment">// 后台处理程序</span></span><br><span class="line">		    dataType : <span class="string">"text"</span>,<span class="comment">// 接受数据格式</span></span><br><span class="line">		    cache: <span class="keyword">false</span>,<span class="comment">//禁用缓存</span></span><br><span class="line">		    <span class="comment">// 回传函数</span></span><br><span class="line">		    success : function(responsedata) &#123;</span><br><span class="line">		        <span class="keyword">if</span>(responsedata==<span class="string">'0'</span>)&#123;</span><br><span class="line">		        	<span class="comment">//popmsg("刷新后可以开始投票！");</span></span><br><span class="line">		        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(responsedata==<span class="string">'1'</span>)&#123;</span><br><span class="line">		            <span class="comment">//alert("1");</span></span><br><span class="line">		        	popmsg(<span class="string">"刷新后可以开始投票！"</span>);</span><br><span class="line">		        &#125;</span><br><span class="line">		    &#125;</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;%</span><br><span class="line">	<span class="keyword">if</span>(canVote == <span class="keyword">true</span>)&#123;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;body onload=<span class="string">"setInitResult();"</span>&gt;</span><br><span class="line">&lt;%</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">%&gt;</span><br><span class="line">		&lt;body onload=<span class="string">"dwr.engine.setActiveReverseAjax(true);"</span>&gt;   &lt;!-- 使用dwr时，若消息是由另一个页面发送的，一定要加这一句  --&gt;</span><br><span class="line">&lt;%</span><br><span class="line">	&#125;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;s:bean name=<span class="string">"com.zcps.configinfo.display.ExpertColumnDisplayManager"</span> id = <span class="string">"cdmanager"</span>&gt;</span><br><span class="line">&lt;div id="maintitlecommit" style="position:fixed;"&gt;专家评审&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;div id=<span class="string">"mainbox"</span>&gt;</span><br><span class="line">&lt;s:form action = <span class="string">"CommitStatsAction.action"</span>  method=<span class="string">"post"</span> namespace=<span class="string">""</span>&gt;</span><br><span class="line">&lt;div style=<span class="string">"width:100%;"</span>&gt;</span><br><span class="line">	&lt;div id=<span class="string">"topline"</span> style=<span class="string">"position:fixed; width:100%; margin: 0px; padding: 0px; "</span>&gt;</span><br><span class="line">		 &lt;div style=<span class="string">"position:fixed; float:left; height:20px; padding-top:10px; padding-bottom: 8px;"</span>&gt;</span><br><span class="line">               &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;%=conferName%&gt;：</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">	&lt;/div&gt;</span><br><span class="line">	&lt;div style=<span class="string">"position:fixed; float:right; height:15px; padding-top:2px; padding-bottom: 8px; right: 10px;"</span>&gt;</span><br><span class="line">		&lt;input type=<span class="string">"hidden"</span> name=<span class="string">"result"</span> value=<span class="string">""</span> id=<span class="string">"result"</span>/&gt;</span><br><span class="line">		&lt;input type=<span class="string">"hidden"</span> name=<span class="string">"commConId"</span> value=<span class="string">"&lt;%=conferId%&gt;"</span>/&gt;</span><br><span class="line">		&lt;input type=<span class="string">"hidden"</span> name=<span class="string">"idenCode"</span> value=<span class="string">"&lt;%=idenCode%&gt;"</span>/&gt;</span><br><span class="line">		&lt;input type=<span class="string">"hidden"</span> name=<span class="string">"isPrinted"</span> value=<span class="string">"false"</span>/&gt;</span><br><span class="line"></span><br><span class="line">&lt;%</span><br><span class="line">	<span class="keyword">if</span>(isAlreadyVote || !canVote)&#123;</span><br><span class="line">%&gt;</span><br><span class="line">	&lt;s:submit value="提交" method="addStats" onclick="return checkAllSubmit();" cssClass="botton" disabled="true"&gt;&lt;/s:submit&gt;</span><br><span class="line">&lt;%</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">%&gt;</span><br><span class="line">	&lt;s:submit id="btnSubmit" value="提交" method="addStats" onclick="return checkAllSubmit();" cssClass="botton"&gt;&lt;/s:submit&gt;</span><br><span class="line">&lt;%</span><br><span class="line">	&#125;</span><br><span class="line">%&gt;</span><br><span class="line">        &amp;nbsp;&lt;input type=<span class="string">"button"</span> id=<span class="string">"btnShow"</span> name=<span class="string">"buttonName"</span> value=<span class="string">"显示字段"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"botton"</span>/&gt;</span><br><span class="line">        &amp;nbsp;&lt;input type=<span class="string">"button"</span> name=<span class="string">"buttonName"</span> value=<span class="string">"刷新"</span> onClick=<span class="string">"window.location.reload(true);"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"botton"</span>/&gt;</span><br><span class="line">	&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;br&gt;&lt;br&gt;</span><br><span class="line">&lt;div id=<span class="string">"mainwordbox"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"spinner"</span> id=<span class="string">"spinner"</span>&gt;</span><br><span class="line">  &lt;img src=<span class="string">"images/loading.gif"</span>/&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;table id=<span class="string">"mytable"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"sortable"</span> style=<span class="string">"display:none"</span>&gt;</span><br><span class="line">	&lt;thead&gt;</span><br><span class="line">		&lt;tr&gt;</span><br><span class="line">			&lt;th noWrap style="width: 270px"&gt;投票选项&lt;/th&gt;</span><br><span class="line">            &lt;th noWrap&gt;评审编号&lt;/th&gt;</span><br><span class="line">            &lt;s:property value=<span class="string">"#cdmanager.displayTHHTML()"</span>  escape=<span class="string">"false"</span>/&gt;&lt;!-- 表格标题部分自定义输出 --&gt;</span><br><span class="line">			&lt;th noWrap colspan=<span class="string">"5"</span> style=<span class="string">"width: 250px"</span>&gt;</span><br><span class="line">                &lt;table style=<span class="string">"width: 100%"</span>&gt;</span><br><span class="line">                    &lt;tr&gt;&lt;th colspan="5" style="width: 100%"&gt;评议组结果&lt;/th&gt;&lt;/tr&gt;</span><br><span class="line">                    &lt;tr&gt;&lt;th&gt;应到人数&lt;/th&gt;</span><br><span class="line">                    &lt;th&gt;实到&lt;/th&gt;</span><br><span class="line">                    &lt;th&gt;同意&lt;/th&gt;</span><br><span class="line">                    &lt;th&gt;不同意&lt;/th&gt;</span><br><span class="line">                    &lt;th&gt;弃权&lt;/th&gt;&lt;/tr&gt;</span><br><span class="line">                &lt;/table&gt;</span><br><span class="line">            &lt;/th&gt;</span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">	&lt;/thead&gt;</span><br><span class="line">	&lt;%</span><br><span class="line">		<span class="keyword">int</span> i = <span class="number">1</span>;</span><br><span class="line">	%&gt;</span><br><span class="line">	&lt;tbody&gt;</span><br><span class="line">		&lt;input type=<span class="string">"hidden"</span> value=<span class="string">"&lt;s:property value="</span>materialViewList.size()<span class="string">"/&gt;"</span> id=<span class="string">"listLength"</span>/&gt;</span><br><span class="line">		&lt;input type=<span class="string">"hidden"</span> value=<span class="string">"&lt;%=round %&gt;"</span> id=<span class="string">"round"</span> name=<span class="string">"round"</span>/&gt;</span><br><span class="line">		&lt;s:iterator value=<span class="string">"materialViewList"</span> id=<span class="string">"ma"</span> status=<span class="string">"sta"</span>&gt;</span><br><span class="line">		&lt;tr&gt;</span><br><span class="line">			&lt;s:hidden value="%&#123;applyId&#125;" id="applyId%&#123;#sta.index&#125;"&gt;&lt;/s:hidden&gt;</span><br><span class="line">			&lt;td&gt;</span><br><span class="line">				&amp;nbsp;&amp;nbsp;</span><br><span class="line">			  	&lt;s:bean name=<span class="string">"com.zcps.commit.manager.CommitStatsManager"</span> id=<span class="string">"stats"</span>&gt;</span><br><span class="line">			  		&lt;s:set name="applyId" value="%&#123;applyId&#125;"&gt;&lt;/s:set&gt;</span><br><span class="line">			  		&lt;s:set name="commConId" value="%&#123;#request.conferId&#125;"&gt;&lt;/s:set&gt;</span><br><span class="line">			  		&lt;s:set name="idenCode" value="%&#123;#request.idenCode&#125;"&gt;&lt;/s:set&gt;</span><br><span class="line">			  		&lt;s:set name="round" value="%&#123;#request.round&#125;"&gt;&lt;/s:set&gt;</span><br><span class="line">			  		&lt;s:<span class="keyword">if</span> test=<span class="string">"#stats.isExist(#applyId, #commConId, #idenCode, #round) == false"</span>&gt;</span><br><span class="line">			  			&lt;% </span><br><span class="line">			  				<span class="keyword">if</span>(canVote == <span class="keyword">false</span>)&#123;</span><br><span class="line">			  			%&gt;</span><br><span class="line">                            &lt;s:radio list="#&#123;'agree':'&amp;nbsp;&amp;nbsp;&lt;span style=color:green&gt;同意&lt;/span&gt;&amp;nbsp;&amp;nbsp;','disagree':'&amp;nbsp;&amp;nbsp;&lt;span style=color:red&gt;不同意&lt;/span&gt;&amp;nbsp;&amp;nbsp;','abondon':'&amp;nbsp;&amp;nbsp;&lt;span style=color:black&gt;弃权&lt;/span&gt;&amp;nbsp;&amp;nbsp;'&#125;" id="radio%&#123;#sta.index&#125;" name="radio%&#123;#sta.index&#125;" disabled="true"&gt;&lt;/s:radio&gt;</span><br><span class="line">			  			&lt;% </span><br><span class="line">			  				&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">null</span> != conferManager.getConferById(conferId).getCommTarget())&#123;</span><br><span class="line">			  			%&gt;</span><br><span class="line">                            &lt;s:radio list="#&#123;'agree':'&amp;nbsp;&amp;nbsp;&lt;span style=color:green&gt;同意&lt;/span&gt;&amp;nbsp;&amp;nbsp;','disagree':'&amp;nbsp;&amp;nbsp;&lt;span style=color:red&gt;不同意&lt;/span&gt;&amp;nbsp;&amp;nbsp;','abondon':'&amp;nbsp;&amp;nbsp;&lt;span style=color:black&gt;弃权&lt;/span&gt;&amp;nbsp;&amp;nbsp;'&#125;" id="radio%&#123;#sta.index&#125;" name="radio%&#123;#sta.index&#125;" value="'abondon'" onclick="saveResult('%&#123;applyId&#125;', this.value, %&#123;#sta.index&#125;)"&gt;&lt;/s:radio&gt;</span><br><span class="line">			  			&lt;% </span><br><span class="line">			  				&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			  			%&gt;</span><br><span class="line">                            &lt;s:radio list="#&#123;'agree':'&amp;nbsp;&amp;nbsp;&lt;span style=color:green&gt;同意&lt;/span&gt;&amp;nbsp;&amp;nbsp;','disagree':'&amp;nbsp;&amp;nbsp;&lt;span style=color:red&gt;不同意&lt;/span&gt;&amp;nbsp;&amp;nbsp;','abondon':'&amp;nbsp;&amp;nbsp;&lt;span style=color:black&gt;弃权&lt;/span&gt;&amp;nbsp;&amp;nbsp;'&#125;" id="radio%&#123;#sta.index&#125;" name="radio%&#123;#sta.index&#125;" value="'agree'" onclick="saveResult('%&#123;applyId&#125;', this.value, %&#123;#sta.index&#125;)"&gt;&lt;/s:radio&gt;</span><br><span class="line">			  			&lt;%</span><br><span class="line">			  				&#125;</span><br><span class="line">			  			%&gt;</span><br><span class="line">			  		&lt;/s:if&gt;</span><br><span class="line">			  		&lt;s:<span class="keyword">else</span>&gt;</span><br><span class="line">                            &lt;s:radio list="#&#123;'agree':'&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;','disagree':'&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;','abondon':'&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;'&#125;" id="radio%&#123;#sta.index&#125;" name="radio%&#123;#sta.index&#125;" onclick="preventCheck()" value="#stats.getExpertResult(#applyId, #commConId, #idenCode, #round)" disabled="true"&gt;&lt;/s:radio&gt;</span><br><span class="line">			  		&lt;/s:else&gt;</span><br><span class="line">			  	&lt;/s:bean&gt;</span><br><span class="line">			  &lt;/td&gt;</span><br><span class="line">            &lt;td noWrap&gt;$&#123;commitReviewNo&#125;&lt;/td&gt;</span><br><span class="line">              &lt;s:property value=<span class="string">"#cdmanager.displayTDHTML(#ma)"</span>  escape=<span class="string">"false"</span>/&gt;&lt;!-- 表格内容部分自定义输出 --&gt;</span><br><span class="line"></span><br><span class="line">			 &lt;%</span><br><span class="line">		      	Integer groResultId =(Integer) request.getAttribute(<span class="string">"groResultId"</span>);</span><br><span class="line">		      	GroupResultManager remanager = <span class="keyword">new</span> GroupResultManager();</span><br><span class="line">		      	GroupResult resultG = remanager.getResultById(groResultId);</span><br><span class="line">		      	<span class="keyword">int</span> total = <span class="number">0</span>;</span><br><span class="line">		      	<span class="keyword">int</span> actual = <span class="number">0</span>;</span><br><span class="line">		      	<span class="keyword">int</span> agree = <span class="number">0</span>;</span><br><span class="line">		      	<span class="keyword">int</span> disagree = <span class="number">0</span>;</span><br><span class="line">		      	<span class="keyword">int</span> abandon = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span>(<span class="keyword">null</span> != resultG)&#123;</span><br><span class="line">					total = resultG.getGroTotoal();</span><br><span class="line">					actual = resultG.getGroActual();</span><br><span class="line">					agree = resultG.getGroAgree();</span><br><span class="line">					disagree = resultG.getGroDisagree();</span><br><span class="line">					abandon = resultG.getGroAbandon();</span><br><span class="line">				&#125;</span><br><span class="line">		      %&gt;</span><br><span class="line">		      &lt;td style="width: 40px"&gt;&lt;%=total %&gt;&lt;/td&gt;</span><br><span class="line">		      &lt;td style="width: 40px"&gt;&lt;%=actual %&gt;&lt;/td&gt;</span><br><span class="line">		      &lt;td style="width: 40px"&gt;&lt;%=agree %&gt;&lt;/td&gt;</span><br><span class="line">		      &lt;td style="width: 40px"&gt;&lt;%=disagree %&gt;&lt;/td&gt;</span><br><span class="line">		      &lt;td style="width: 40px"&gt;&lt;%=abandon %&gt;&lt;/td&gt;</span><br><span class="line">		      </span><br><span class="line">		      &lt;%</span><br><span class="line">				i++;</span><br><span class="line">			  %&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">		&lt;/s:iterator&gt;</span><br><span class="line">	&lt;/tbody&gt;</span><br><span class="line">&lt;/table&gt;</span><br><span class="line">	&lt;%</span><br><span class="line">	<span class="keyword">if</span>(commitConfer.getConferStatus().equals(Status.CONFER_BEGIN.getStatus()))&#123;</span><br><span class="line">	%&gt;</span><br><span class="line">		&lt;div id = <span class="string">"js"</span> align=<span class="string">"center"</span> style=<span class="string">"display:none;position:relative; height:15px; font-family:serif; font-size: 13px; color: red; margin: auto;"</span>&gt;</span><br><span class="line">			当前材料&lt;s:property value=<span class="string">"materialViewList.size()"</span>/&gt;份，同意<span class="number">0</span>票，不同意&lt;%=disAgreeNumber %&gt;票，弃权&lt;%=abondonNumber %&gt;票!</span><br><span class="line">		&lt;/div&gt;</span><br><span class="line">	&lt;%</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(!isAlreadyVote)&#123;</span><br><span class="line">	%&gt;</span><br><span class="line">	&lt;div id = <span class="string">"js"</span> align=<span class="string">"center"</span> style=<span class="string">"display:none;position:relative; height:15px; font-family:serif; font-size: 13px; color: red; margin: auto;"</span>&gt;</span><br><span class="line">		您的投票结果为：同意&lt;%=agreeNumber%&gt;票，不同意&lt;%=disAgreeNumber %&gt;票，弃权&lt;%=abondonNumber %&gt;票!</span><br><span class="line">	&lt;/div&gt;</span><br><span class="line">	&lt;%</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(isAlreadyVote)&#123;</span><br><span class="line">	%&gt;</span><br><span class="line">	&lt;div align=<span class="string">"center"</span> style=<span class="string">"display:none;position:relative; height:15px; padding-top:8px; padding-bottom: 8px; font-size:13px; color:red; text-align: center; width:100%; margin: auto; "</span>&gt;</span><br><span class="line">		&lt;span&gt;您的投票结果为：同意&lt;%=agreeNumber%&gt;票，不同意&lt;%=disAgreeNumber %&gt;票，弃权&lt;%=abondonNumber %&gt;票!&lt;/span&gt;</span><br><span class="line">	&lt;/div&gt;</span><br><span class="line">	&lt;%</span><br><span class="line">	&#125;</span><br><span class="line">	%&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/s:form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">    &lt;div id=<span class="string">"displaydiv"</span> &gt;</span><br><span class="line">        &lt;div style=<span class="string">"text-align:left;"</span>&gt;</span><br><span class="line">            &lt;form id=<span class="string">"myForm"</span> action=<span class="string">"AppMaterialAction!getMaterialsByCommitConfer.action"</span>  method=<span class="string">"post"</span>&gt;</span><br><span class="line">                &lt;s:checkboxlist name=<span class="string">"configValue"</span> list=<span class="string">"#cdmanager.setAllColumn()"</span> listKey=<span class="string">"enname"</span> listValue=<span class="string">"cnname"</span> value=<span class="string">"#cdmanager.getDisplayString()"</span> /&gt;</span><br><span class="line">                &lt;br/&gt;&lt;s:hidden name="conferId" value="%&#123;conferId&#125;"&gt;&lt;/s:hidden&gt;</span><br><span class="line">                &lt;s:submit value="设置"&gt;&lt;/s:submit&gt;</span><br><span class="line">                &lt;input type=<span class="string">"button"</span> id=<span class="string">"btnHide"</span> name=<span class="string">"buttonName"</span> value=<span class="string">"取消"</span>/&gt;</span><br><span class="line">            &lt;/form&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/s:bean&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;script&gt;  </span><br><span class="line">$(<span class="string">"#mytable"</span>).css(<span class="string">'display'</span>,<span class="string">'inline'</span>); </span><br><span class="line">$(<span class="string">"#js"</span>).css(<span class="string">'display'</span>,<span class="string">'inline'</span>); </span><br><span class="line">$(<span class="string">"#spinner"</span>).css(<span class="string">'display'</span>,<span class="string">'none'</span>); </span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>新实现的代码:<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> <span class="keyword">import</span>=<span class="string">"java.util.*,com.zcps.system.configs.*, com.zcps.group.dao.GroupResult, </span></span><br><span class="line"><span class="string">	com.zcps.info.manager.*, com.zcps.commit.dao.*, com.zcps.commit.manager.*,com.zcps.group.manager.*, com.zcps.commit.manager.* ,com.zcps.system.configs.Status"</span> pageEncoding=<span class="string">"GBK"</span>%&gt;</span><br><span class="line">&lt;%@ taglib uri=<span class="string">"/struts-tags"</span>  prefix=<span class="string">"s"</span> %&gt;</span><br><span class="line">&lt;%</span><br><span class="line">	String path = request.getContextPath();</span><br><span class="line">	String basePath = request.getScheme()+<span class="string">"://"</span>+request.getServerName()+<span class="string">":"</span>+request.getServerPort()+path+<span class="string">"/"</span>;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;%</span><br><span class="line">	session = request.getSession(<span class="keyword">true</span>);</span><br><span class="line">	String confer = (String)session.getAttribute(<span class="string">"confer"</span>);</span><br><span class="line">	String idenCode = (String)session.getAttribute(<span class="string">"idenCode"</span>);</span><br><span class="line">	Integer conferId = (Integer)session.getAttribute(<span class="string">"conferId"</span>);</span><br><span class="line">	request.setAttribute(<span class="string">"idenCode"</span>, idenCode);</span><br><span class="line">	request.setAttribute(<span class="string">"conferId"</span>, conferId);</span><br><span class="line">	</span><br><span class="line">	CommitConferManager commitConferManager = <span class="keyword">new</span> CommitConferManager(); <span class="comment">//更具会议</span></span><br><span class="line">	<span class="keyword">int</span> round = commitConferManager.getConferRound(conferId);</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	request.setAttribute(<span class="string">"round"</span>, round);</span><br><span class="line">	CommitStatsManager statsManager = <span class="keyword">new</span> CommitStatsManager();</span><br><span class="line">	</span><br><span class="line">	String commitName = <span class="string">""</span>;</span><br><span class="line">	String conferName = <span class="string">""</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//CommitConferManager manager = new CommitConferManager();</span></span><br><span class="line">	CommitInfoManager commitInfoManager = <span class="keyword">new</span> CommitInfoManager();</span><br><span class="line">	<span class="comment">//已知conferId</span></span><br><span class="line">	<span class="comment">//已知idenCode</span></span><br><span class="line">	</span><br><span class="line">	CommitConfer commitConfer = commitConferManager.getConferById(conferId);</span><br><span class="line">	conferName = commitConfer.getConferName();</span><br><span class="line">	commitName = commitInfoManager.getCommit(commitConfer.getCommId()).getCommName();	</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">boolean</span> canVote = <span class="keyword">false</span>;</span><br><span class="line">	<span class="keyword">boolean</span> already = <span class="keyword">true</span>; <span class="comment">//后面根本没用到</span></span><br><span class="line">	</span><br><span class="line">	Integer conferStatus=-<span class="number">1</span>; <span class="comment">//初始化</span></span><br><span class="line">	<span class="comment">//对该用户分为：状态分为 会议开始阶段（[等于会议挂起状态]不允许投票）0，投票是开始阶段1，该用户投票结束2</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>(commitConfer.getConferStatus().equals(Status.CONFER_VOTE_BEGGIN.getStatus()))&#123; <span class="comment">//投票开始</span></span><br><span class="line">		canVote = <span class="keyword">true</span>;</span><br><span class="line">		conferStatus=<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(commitConfer.getConferStatus().equals(Status.CONFER_BEGIN.getStatus())||commitConfer.getConferStatus().equals(Status.CONFER_SUSPEND.getStatus()))&#123; <span class="comment">//会议开始</span></span><br><span class="line">		already= <span class="keyword">false</span>;</span><br><span class="line">		conferStatus=<span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> agreeNumber = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> disAgreeNumber = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> abondonNumber = <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//查询该许可吗用户是否已经投过票了，表该会议里该轮，表有票就是投过票了</span></span><br><span class="line">	<span class="keyword">boolean</span> isAlreadyVote = statsManager.isAlreadyVote(idenCode, conferId, round);</span><br><span class="line">	<span class="keyword">if</span>(isAlreadyVote)&#123;</span><br><span class="line">		agreeNumber = statsManager.getAgreeCount(conferId, idenCode, round);</span><br><span class="line">		disAgreeNumber = statsManager.getDisAgreeCount(conferId, idenCode, round);</span><br><span class="line">		abondonNumber = statsManager.getAbondonCount(conferId, idenCode, round);</span><br><span class="line">		conferStatus=<span class="number">2</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> defaultAgree;  <span class="comment">//默认同意</span></span><br><span class="line">	<span class="keyword">if</span>(<span class="keyword">null</span> != commitConferManager.getConferById(conferId).getCommTarget())</span><br><span class="line">		defaultAgree = <span class="number">0</span>;  <span class="comment">//放弃</span></span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		defaultAgree = <span class="number">1</span>; <span class="comment">//同意</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> maxAgree = <span class="number">10000</span>;</span><br><span class="line">	<span class="keyword">if</span>(<span class="keyword">null</span> != commitConfer.getCommTarget())&#123;</span><br><span class="line">		maxAgree = commitConfer.getCommTarget();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//查询出 某次会议，某许可证，某论的投票 的评审结果</span></span><br><span class="line">	CommitStatsManager commitStatsManager =<span class="keyword">new</span> CommitStatsManager();</span><br><span class="line">    List list=commitStatsManager.searchStatsByIdenAndComConIdAndRound(idenCode, conferId, round);</span><br><span class="line">   <span class="comment">// System.out.println(list.size());</span></span><br><span class="line">	<span class="comment">/*Iterator it=list.iterator();</span></span><br><span class="line"><span class="comment">	while(it.hasNext())&#123;</span></span><br><span class="line"><span class="comment">		CommitStats commitStatas=(CommitStats)it.next();</span></span><br><span class="line"><span class="comment">		System.out.println(commitStatas.getIdenCode()+" "+commitStatas.getResult());</span></span><br><span class="line"><span class="comment">	&#125;*/</span></span><br><span class="line">	<span class="keyword">if</span>(defaultAgree==<span class="number">0</span>)</span><br><span class="line">		request.setAttribute(<span class="string">"defaultAgree"</span>,<span class="keyword">new</span> String(<span class="string">"abondon"</span>));</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		request.setAttribute(<span class="string">"defaultAgree"</span>,<span class="keyword">new</span> String(<span class="string">"agree"</span>));</span><br><span class="line">	</span><br><span class="line">	request.setAttribute(<span class="string">"commitStatsList"</span>,list); <span class="comment">//查询来当前会议的材料</span></span><br><span class="line">    <span class="comment">//request.setAttribute("canVote",canVote);</span></span><br><span class="line">    request.setAttribute(<span class="string">"conferStatus"</span>,conferStatus);  <span class="comment">//会议状态</span></span><br><span class="line">    <span class="comment">//CommitStatsManager</span></span><br><span class="line">    <span class="comment">//getStatsByIdenAndCommConId(idenCode, conferId);</span></span><br><span class="line">    <span class="comment">//Status constItem =Status("");</span></span><br><span class="line"> <span class="comment">//   request.setAttribute("constItem", constItem);</span></span><br><span class="line">    </span><br><span class="line">	</span><br><span class="line">%&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html PUBLIC <span class="string">"-//W3C//DTD XHTML 1.0 Transitional//EN"</span>&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=gbk"</span> /&gt;</span><br><span class="line">&lt;title&gt;all of the materials&lt;/title&gt;</span><br><span class="line">&lt;link href=<span class="string">"css/public.css"</span> rel=<span class="string">"stylesheet"</span> type=<span class="string">"text/css"</span> /&gt;</span><br><span class="line">&lt;link href=<span class="string">"css/main.css"</span> rel=<span class="string">"stylesheet"</span> type=<span class="string">"text/css"</span> /&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">  body&#123;</span><br><span class="line">  	<span class="comment">/*min-width: 1100px;*/</span></span><br><span class="line">  &#125;</span><br><span class="line"> th&#123;</span><br><span class="line"> 	font-size: <span class="number">15</span>px;</span><br><span class="line"> 	margin: <span class="number">0</span>px;</span><br><span class="line"> 	padding:<span class="number">2</span>px;</span><br><span class="line"> 	padding-left:<span class="number">4</span>px;</span><br><span class="line"> &#125;</span><br><span class="line"> td&#123;</span><br><span class="line"> 	font-size: <span class="number">15</span>px;</span><br><span class="line"> 	text-align: center;</span><br><span class="line"> 	</span><br><span class="line"> &#125;</span><br><span class="line"> tr&#123;</span><br><span class="line"> 	width:<span class="number">100</span>%;</span><br><span class="line"> &#125;</span><br><span class="line">	</span><br><span class="line"> </span><br><span class="line"> span&#123;</span><br><span class="line">	display:inline-table;</span><br><span class="line"> &#125;</span><br><span class="line"> #mainbox&#123;</span><br><span class="line"> 	border: 0px solid #adb9c5;</span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line"> .spinner &#123;</span><br><span class="line">    width:<span class="number">300</span>px;</span><br><span class="line">     height:<span class="number">200</span>px;</span><br><span class="line">    position:absolute; </span><br><span class="line">    left:<span class="number">55</span>%; top:<span class="number">50</span>%; </span><br><span class="line">    margin:-<span class="number">100</span>px <span class="number">0</span> <span class="number">0</span> -<span class="number">150</span>px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> .spinner img&#123;</span><br><span class="line">  position:relitive;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line">#topline &#123;</span><br><span class="line">	background-image: url(./images/titlefieldvote2.png);</span><br><span class="line">	height: <span class="number">28</span>px;</span><br><span class="line">	width: <span class="number">220</span>px;</span><br><span class="line">	text-indent: <span class="number">35</span>px;</span><br><span class="line">	vertical-align: baseline;</span><br><span class="line">	padding-top: <span class="number">10</span>px;</span><br><span class="line">	top: <span class="number">20</span>px;</span><br><span class="line">	left:<span class="number">2</span>px;</span><br><span class="line">	font-size: <span class="number">13</span>px;</span><br><span class="line">	position: absolute;</span><br><span class="line">    &#125;</span><br><span class="line">    #maintitlecommit &#123;</span><br><span class="line">		background-image: url(./images/titlefieldvote1.png);</span><br><span class="line">		height: <span class="number">15</span>px;</span><br><span class="line">		width: <span class="number">1500</span>px;</span><br><span class="line">		margin-right: <span class="number">10</span>px;</span><br><span class="line">		margin-left: <span class="number">2</span>px;</span><br><span class="line">		text-indent: <span class="number">35</span>px;</span><br><span class="line">		vertical-align: baseline;</span><br><span class="line">		padding-top: <span class="number">6</span>px;</span><br><span class="line">		z-index: <span class="number">3</span>;</span><br><span class="line">		top: <span class="number">2</span>px;</span><br><span class="line">		font-size: <span class="number">13</span>px;</span><br><span class="line">		position: absolute;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    ul&#123;</span><br><span class="line">		list-style-type:none;</span><br><span class="line">		margin:<span class="number">0</span>;</span><br><span class="line">		padding:<span class="number">0</span>;</span><br><span class="line">		<span class="comment">/*padding-top:6px;</span></span><br><span class="line"><span class="comment">		padding-bottom:6px;*/</span></span><br><span class="line">		height:<span class="number">40</span>px;</span><br><span class="line">	&#125;</span><br><span class="line">	li&#123;</span><br><span class="line">		display:list-item;</span><br><span class="line">		<span class="keyword">float</span>:left;</span><br><span class="line">		height:<span class="number">40</span>px;</span><br><span class="line">		margin-left: <span class="number">2</span>px;</span><br><span class="line">	&#125;</span><br><span class="line">	#nav&gt;ul&gt;li&gt;a&#123;</span><br><span class="line">		display:block;</span><br><span class="line">		background-color:#FFFFF;</span><br><span class="line">		text-align:center;</span><br><span class="line">		border-radius: <span class="number">4</span>px;</span><br><span class="line">		<span class="comment">/*padding:6px;*/</span></span><br><span class="line">		text-decoration:none;</span><br><span class="line">		text-transform:uppercase;</span><br><span class="line">		color: #337ab7;</span><br><span class="line">        text-decoration: none;</span><br><span class="line">        <span class="comment">/*width:100%;*/</span></span><br><span class="line">        <span class="comment">/*height:100%;*/</span></span><br><span class="line">        padding: <span class="number">10</span>px <span class="number">10</span>px;</span><br><span class="line">        margin:<span class="number">0</span> auto;</span><br><span class="line">	&#125;</span><br><span class="line">	#nav&gt;ul&gt;li&gt;a:hover,a:active&#123;</span><br><span class="line">		color: #fff;</span><br><span class="line">    	background-color: #337ab7;</span><br><span class="line">    	</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;script src="js/jquery-1.6.2.min.js"&gt;&lt;/script&gt;</span><br><span class="line">&lt;script type='text/javascript' src='js/jquery.messager.js'&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src="js/jquery.cookie.js"&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src="js/checkbox.js" type="text/javascript"&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src="js/map.js" type="text/javascript"&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src="js/client.js"&gt;&lt;/script&gt;</span><br><span class="line">&lt;script type='text/javascript' src='&lt;%=basePath%&gt;dwr/engine.js'&gt;&lt;/script&gt;</span><br><span class="line">&lt;script type='text/javascript' src='&lt;%=basePath%&gt;dwr/interface/Remote.js'&gt;&lt;/script&gt;</span><br><span class="line">&lt;script type="text/javascript" src="js/display2.js"&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;script type=<span class="string">"text/javascript"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;s:<span class="keyword">if</span> test=<span class="string">"#request.conferStatus==1"</span>&gt;</span><br><span class="line">	&lt;body onload=<span class="string">"initResult();"</span> &gt;</span><br><span class="line">&lt;/s:if&gt;</span><br><span class="line">&lt;s:<span class="keyword">else</span>&gt;</span><br><span class="line">	&lt;body onload=<span class="string">"dwr.engine.setActiveReverseAjax(true);"</span>&gt; </span><br><span class="line">	&lt;!-- 使用dwr时，若消息是由另一个页面发送的，一定要加这一句  --&gt;</span><br><span class="line">&lt;/s:else&gt;</span><br><span class="line"></span><br><span class="line">&lt;s:bean name=<span class="string">"com.zcps.configinfo.display.ExpertColumnDisplayManager"</span> id = <span class="string">"cdmanager"</span>&gt;</span><br><span class="line">&lt;div id="maintitlecommit" style="position:fixed;"&gt;专家评审&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;div id=<span class="string">"mainbox"</span>&gt;</span><br><span class="line">&lt;s:form action = <span class="string">"CommitStatsAction.action"</span>  method=<span class="string">"post"</span> namespace=<span class="string">""</span>&gt;</span><br><span class="line">&lt;div style=<span class="string">"width:100%;"</span>&gt;</span><br><span class="line">	&lt;div id=<span class="string">"topline"</span> style=<span class="string">"position:fixed; width:100%; margin: 0px; padding: 0px; "</span>&gt;</span><br><span class="line">		 &lt;div style=<span class="string">"position:fixed; float:left; height:20px; padding-top:10px; padding-bottom: 8px;"</span>&gt;</span><br><span class="line">               &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;%=conferName%&gt;：</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">	&lt;/div&gt;</span><br><span class="line">	&lt;div style=<span class="string">"position:fixed; float:right; height:15px; padding-top:2px; padding-bottom: 8px; right: 10px;"</span>&gt;</span><br><span class="line">		&lt;input type=<span class="string">"hidden"</span> name=<span class="string">"result"</span> value=<span class="string">""</span> id=<span class="string">"result"</span>/&gt;</span><br><span class="line">		&lt;input type=<span class="string">"hidden"</span> name=<span class="string">"commConId"</span> value=<span class="string">"&lt;%=conferId%&gt;"</span>/&gt;</span><br><span class="line">		&lt;input type=<span class="string">"hidden"</span> name=<span class="string">"idenCode"</span> value=<span class="string">"&lt;%=idenCode%&gt;"</span>/&gt;</span><br><span class="line">		&lt;input type=<span class="string">"hidden"</span> name=<span class="string">"isPrinted"</span> value=<span class="string">"false"</span>/&gt;</span><br><span class="line"></span><br><span class="line">		</span><br><span class="line">		&lt;s:<span class="keyword">if</span> test=<span class="string">"#request.conferStatus!=1"</span>&gt;</span><br><span class="line">			&lt;s:submit value="提交" method="addStats" onclick="return checkAllSubmit();" cssClass="botton" disabled="true"&gt;&lt;/s:submit&gt;</span><br><span class="line">		&lt;/s:if&gt;</span><br><span class="line">		&lt;s:<span class="keyword">else</span>&gt;</span><br><span class="line">		&lt;!-- 			设定默认投票选项： --&gt;</span><br><span class="line">			&lt;select id=<span class="string">"defaultSelect"</span>&gt;</span><br><span class="line">					&lt;option value="1"&gt;学科组投票结果&lt;/option&gt;</span><br><span class="line">					&lt;option value="2"&gt;全部同意&lt;/option&gt;</span><br><span class="line">					&lt;option value="3"&gt;全部不同意&lt;/option&gt;</span><br><span class="line">					&lt;option value="4"&gt;全部放弃&lt;/option&gt;</span><br><span class="line">			&lt;/select&gt;</span><br><span class="line">		  &lt;input type=<span class="string">"button"</span> value=<span class="string">"默认设定"</span> id=<span class="string">"sel_btn"</span>  <span class="class"><span class="keyword">class</span></span>=<span class="string">"botton"</span> onclick=<span class="string">"clickSel_Btn()"</span>/&gt;</span><br><span class="line">		  &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;</span><br><span class="line">		 &lt;s:submit id="btnSubmit" value="提交" method="addStats" onclick="return checkAllSubmit();" cssClass="botton"&gt;&lt;/s:submit&gt;</span><br><span class="line">		&lt;/s:else&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">     &lt;!--    &amp;nbsp;&lt;input type=<span class="string">"button"</span> id=<span class="string">"btnShow"</span> name=<span class="string">"buttonName"</span> value=<span class="string">"显示字段"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"botton"</span>/&gt; --&gt;</span><br><span class="line">        &amp;nbsp;&lt;input type=<span class="string">"button"</span> name=<span class="string">"buttonName"</span> value=<span class="string">"刷新"</span> onClick=<span class="string">"window.location.reload(true);"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"botton"</span>/&gt;</span><br><span class="line">	&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;br&gt;&lt;br&gt;</span><br><span class="line">&lt;div id=<span class="string">"mainwordbox"</span> style=<span class="string">"border-width:0px;"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"spinner"</span> id=<span class="string">"spinner"</span>&gt;</span><br><span class="line">  &lt;img src=<span class="string">"images/loading.gif"</span>/&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;!-- &lt;div id=<span class="string">"nav"</span> style=<span class="string">"display:none;"</span>&gt;</span><br><span class="line">	&lt;ul&gt;</span><br><span class="line">		&lt;li&gt;&lt;a href="#home"&gt;学科组1&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		&lt;li&gt;&lt;a href="#news"&gt;学科组2&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		&lt;li&gt;&lt;a href="#contact"&gt;学科组3&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">		&lt;li&gt;&lt;a href="#about"&gt;学科组4&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">	&lt;/ul&gt;</span><br><span class="line">&lt;/div&gt; --&gt;</span><br><span class="line">&lt;div id=<span class="string">"divheadtable"</span> style=<span class="string">"overflow-x: hidden;border-top:2px solid #8F99A2;border-left:2px solid #8F99A2;display:none;position:fixed;top:60px; "</span> &gt;</span><br><span class="line">	&lt;table id =<span class="string">"headtable"</span> style=<span class="string">"min-width:900px;"</span>&gt;</span><br><span class="line"></span><br><span class="line">	&lt;thead&gt;</span><br><span class="line">		&lt;tr&gt;</span><br><span class="line">			&lt;th noWrap style="width: 240px"&gt;投票选项&lt;/th&gt;</span><br><span class="line">            &lt;th&gt;评审编号&lt;/th&gt;</span><br><span class="line">            &lt;th&gt;姓名&lt;/th&gt;</span><br><span class="line">            &lt;th&gt;性别&lt;/th&gt;</span><br><span class="line">            &lt;th&gt;申报资格名称&lt;/th&gt;</span><br><span class="line">            &lt;th&gt;工作单位&lt;/th&gt;</span><br><span class="line">        	 &lt;%--    &lt;s:property value=<span class="string">"#cdmanager.displayTHHTML()"</span>  escape=<span class="string">"false"</span>/&gt; --%&gt;</span><br><span class="line">            </span><br><span class="line">            &lt;!-- 表格标题部分自定义输出 --&gt;</span><br><span class="line">			&lt;th  colspan=<span class="string">"5"</span> style=<span class="string">" padding-left: 0px; padding-right: 0px; border-width: 0px;"</span>&gt;</span><br><span class="line">                &lt;table style=<span class="string">"width: 100%"</span> id=<span class="string">"grtable"</span>&gt;</span><br><span class="line">                    &lt;tr&gt;&lt;th colspan="5" style="width: 100%"&gt;评议组结果&lt;/th&gt;&lt;/tr&gt;</span><br><span class="line">                    &lt;tr&gt; </span><br><span class="line">                    	&lt;th style="width: 40px"&gt;应到人数&lt;/th&gt;</span><br><span class="line">	                    &lt;th style="width: 40px"&gt;实到&lt;/th&gt;</span><br><span class="line">	                    &lt;th style="width: 40px"&gt;同意&lt;/th&gt;</span><br><span class="line">	                    &lt;th style="width: 40px" &gt;不同意&lt;/th&gt;</span><br><span class="line">	                    &lt;th style="width: 40px"&gt;弃权&lt;/th&gt;</span><br><span class="line">                    &lt;/tr&gt;</span><br><span class="line">                &lt;/table&gt;</span><br><span class="line">            &lt;/th&gt;</span><br><span class="line">           &lt;!--  &lt;th&gt;&lt;/th&gt; --&gt;</span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">	&lt;/thead&gt;</span><br><span class="line">&lt;/table&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;div id=<span class="string">"divtab"</span> style=<span class="string">"display:none;position:fixed;top:200px;width:99%; bottom:30px;overflow-y:scroll; margin-right:0px;border-left:2px solid #8F99A2;"</span>&gt;</span><br><span class="line">	&lt;table id=<span class="string">"mytable"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"sortable"</span> style=<span class="string">"min-width:900px;"</span> &gt;</span><br><span class="line">		&lt;tbody style=<span class="string">""</span>&gt;</span><br><span class="line">			&lt;input type=<span class="string">"hidden"</span> value=<span class="string">"&lt;s:property value="</span>materialGroupresViewList.size()<span class="string">"/&gt;"</span> id=<span class="string">"listLength"</span>/&gt;</span><br><span class="line">			&lt;input type=<span class="string">"hidden"</span> value=<span class="string">"&lt;%=round %&gt;"</span> id=<span class="string">"round"</span> name=<span class="string">"round"</span>/&gt;</span><br><span class="line">			</span><br><span class="line">			&lt;s:iterator value=<span class="string">"materialGroupresViewList"</span> id=<span class="string">"ma"</span> status=<span class="string">"sta"</span>&gt;</span><br><span class="line">			&lt;tr &gt;</span><br><span class="line">				&lt;s:hidden value="%&#123;applyId&#125;" id="applyId%&#123;#sta.index&#125;"&gt;&lt;/s:hidden&gt;</span><br><span class="line">				&lt;td noWrap style=<span class="string">"width: 240px"</span>&gt;</span><br><span class="line">					&amp;nbsp;&amp;nbsp;</span><br><span class="line">						&lt;!-- 通过conferid，idencode,round size=<span class="number">0</span>,没有投过票 --&gt;</span><br><span class="line">						&lt;s:<span class="keyword">if</span> test=<span class="string">"#request.commitStatsList.size() == 0"</span>&gt;</span><br><span class="line">							&lt;!-- 会议开始阶段，（没开始投票） --&gt;</span><br><span class="line">							&lt;s:<span class="keyword">if</span> test=<span class="string">"#request.conferStatus == 0"</span>&gt;</span><br><span class="line">								 &lt;s:radio list="#&#123;'agree':'&amp;nbsp;&amp;nbsp;&lt;span style=color:green&gt;同意&lt;/span&gt;&amp;nbsp;&amp;nbsp;','disagree':'&amp;nbsp;&amp;nbsp;&lt;span style=color:red&gt;不同意&lt;/span&gt;&amp;nbsp;&amp;nbsp;','abondon':'&amp;nbsp;&amp;nbsp;&lt;span style=color:black&gt;弃权&lt;/span&gt;&amp;nbsp;&amp;nbsp;'&#125;" id="radio%&#123;#sta.index&#125;" name="radio%&#123;#sta.index&#125;" disabled="true"&gt;&lt;/s:radio&gt;</span><br><span class="line">							&lt;/s:if&gt;</span><br><span class="line">							&lt;!-- 开始投票阶段 --&gt;</span><br><span class="line">							&lt;s:<span class="keyword">if</span> test=<span class="string">"#request.conferStatus == 1"</span>&gt;</span><br><span class="line">				                  &lt;s:radio list="#&#123;'agree':'&amp;nbsp;&amp;nbsp;&lt;span style=color:green&gt;同意&lt;/span&gt;&amp;nbsp;&amp;nbsp;','disagree':'&amp;nbsp;&amp;nbsp;&lt;span style=color:red&gt;不同意&lt;/span&gt;&amp;nbsp;&amp;nbsp;','abondon':'&amp;nbsp;&amp;nbsp;&lt;span style=color:black&gt;弃权&lt;/span&gt;&amp;nbsp;&amp;nbsp;'&#125;" id="radio%&#123;#sta.index&#125;" name="radio%&#123;#sta.index&#125;" value="%&#123;#request.defaultAgree&#125;" onclick="saveResult(%&#123;#ma.applyId&#125;, this.value, %&#123;#sta.index&#125;)"&gt;&lt;/s:radio&gt;</span><br><span class="line">							&lt;/s:if&gt;								</span><br><span class="line">						&lt;/s:if&gt;</span><br><span class="line">						&lt;s:<span class="keyword">else</span>&gt;</span><br><span class="line">								&lt;s:iterator value=<span class="string">"#request.commitStatsList"</span> id=<span class="string">"commitStats"</span>&gt;</span><br><span class="line">									&lt;s:<span class="keyword">if</span> test=<span class="string">"#commitStats.applyId == #ma.applyId"</span>&gt;	</span><br><span class="line">										&lt;%-- &lt;s:a value="%&#123;#commitStats.result&#125;"&gt;&lt;/s:a&gt; --%&gt;</span><br><span class="line">										&lt;s:<span class="keyword">if</span> test =<span class="string">"#commitStats.result == @com.zcps.system.configs.Status@CONFER_RESULT_AGREE.getStatus()"</span>&gt;</span><br><span class="line">												&lt;s:radio list="#&#123;'agree':'&amp;nbsp;&amp;nbsp;&lt;span style=color:green&gt;同意&lt;/span&gt;&amp;nbsp;&amp;nbsp;','disagree':'&amp;nbsp;&amp;nbsp;&lt;span style=color:red&gt;不同意&lt;/span&gt;&amp;nbsp;&amp;nbsp;','abondon':'&amp;nbsp;&amp;nbsp;&lt;span style=color:black&gt;弃权&lt;/span&gt;&amp;nbsp;&amp;nbsp;'&#125;" id="radio%&#123;#sta.index&#125;" name="radio%&#123;#sta.index&#125;" onclick="preventCheck()" value="'agree'" disabled="true"&gt;&lt;/s:radio&gt;</span><br><span class="line">										&lt;/s:if&gt;</span><br><span class="line">																			&lt;s:<span class="keyword">if</span> test =<span class="string">"#commitStats.result == @com.zcps.system.configs.Status@CONFER_RESULT_DISAGREE.getStatus()"</span>&gt;</span><br><span class="line">												&lt;s:radio list="#&#123;'agree':'&amp;nbsp;&amp;nbsp;&lt;span style=color:green&gt;同意&lt;/span&gt;&amp;nbsp;&amp;nbsp;','disagree':'&amp;nbsp;&amp;nbsp;&lt;span style=color:red&gt;不同意&lt;/span&gt;&amp;nbsp;&amp;nbsp;','abondon':'&amp;nbsp;&amp;nbsp;&lt;span style=color:black&gt;弃权&lt;/span&gt;&amp;nbsp;&amp;nbsp;'&#125;" id="radio%&#123;#sta.index&#125;" name="radio%&#123;#sta.index&#125;" onclick="preventCheck()" value="'disagree'" disabled="true"&gt;&lt;/s:radio&gt;</span><br><span class="line">										&lt;/s:if&gt;</span><br><span class="line">																			&lt;s:<span class="keyword">if</span> test =<span class="string">"#commitStats.result == @com.zcps.system.configs.Status@CONFER_RESULT_ABONDON.getStatus()"</span>&gt;</span><br><span class="line">												&lt;s:radio list="#&#123;'agree':'&amp;nbsp;&amp;nbsp;&lt;span style=color:green&gt;同意&lt;/span&gt;&amp;nbsp;&amp;nbsp;','disagree':'&amp;nbsp;&amp;nbsp;&lt;span style=color:red&gt;不同意&lt;/span&gt;&amp;nbsp;&amp;nbsp;','abondon':'&amp;nbsp;&amp;nbsp;&lt;span style=color:black&gt;弃权&lt;/span&gt;&amp;nbsp;&amp;nbsp;'&#125;" id="radio%&#123;#sta.index&#125;" name="radio%&#123;#sta.index&#125;" onclick="preventCheck()" value="'abondon'" disabled="true"&gt;&lt;/s:radio&gt;</span><br><span class="line">										&lt;/s:if&gt;</span><br><span class="line">									&lt;/s:if&gt;</span><br><span class="line">								&lt;/s:iterator&gt;</span><br><span class="line">							   </span><br><span class="line">						&lt;/s:else&gt;</span><br><span class="line">						</span><br><span class="line">	</span><br><span class="line">				  &lt;/td&gt;</span><br><span class="line">	           	  &lt;td &gt;$&#123;commitReviewNo&#125;&lt;/td&gt;</span><br><span class="line">	           	  &lt;td &gt;&lt;a href="readappmaterial.jsp?applyId=&lt;s:property value="#ma.applyId" escape="false"/&gt;" target="_blank"&gt;&lt;s:property value="#ma.name" escape="false"/&gt;&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">	           	  &lt;td &gt;&lt;s:property value="#ma.sex" escape="false"/&gt;&lt;/td&gt;</span><br><span class="line">	           	  &lt;td &gt;&lt;s:property value="#ma.applyTitle" escape="false"/&gt;&lt;/td&gt;</span><br><span class="line">	           	  &lt;td &gt;&lt;s:property value="#ma.organization" escape="false"/&gt;&lt;/td&gt;</span><br><span class="line">	           	  </span><br><span class="line">	              &lt;%-- &lt;s:property value=<span class="string">"#cdmanager.displayTDHTML(#ma)"</span>  escape=<span class="string">"false"</span>/&gt; --%&gt;</span><br><span class="line">	              &lt;!-- 表格内容部分自定义输出 --&gt;</span><br><span class="line">	  </span><br><span class="line">				  &lt;td  style="width: 40px"&gt;&lt;s:property value="#ma.groTotoal" escape="false"/&gt;&lt;/td&gt;</span><br><span class="line">	 			  &lt;td  style="width: 40px"&gt;&lt;s:property value="#ma.groActual" escape="false"/&gt;&lt;/td&gt;</span><br><span class="line">			      &lt;td style="width: 40px"&gt;&lt;s:property value="#ma.groAgree" escape="false"/&gt;&lt;/td&gt;</span><br><span class="line">			      &lt;td  style="width: 40px"&gt;&lt;s:property value="#ma.groDisagree" escape="false"/&gt;&lt;/td&gt;</span><br><span class="line">			      &lt;td  style="width: 40px"&gt;&lt;s:property value="#ma.groAbandon" escape="false"/&gt;&lt;/td&gt;		 </span><br><span class="line">	        &lt;/tr&gt;</span><br><span class="line">			&lt;/s:iterator&gt;</span><br><span class="line">			</span><br><span class="line">		&lt;/tbody&gt;</span><br><span class="line">	&lt;/table&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;s:<span class="keyword">if</span> test=<span class="string">"#request.conferStatus==0"</span>&gt;</span><br><span class="line">	&lt;div id=<span class="string">"js"</span> align=<span class="string">"center"</span> style=<span class="string">"position:fixed;bottom:0px;display:none; width:auto;color: red;padding-top:8px; padding-bottom: 8px; height:15px; font-family:serif; font-size: 13px;  margin: auto;"</span>&gt;</span><br><span class="line">		&lt;span&gt;当前材料&lt;s:property value="materialViewList.size()"/&gt;份，同意0票，不同意&lt;%=disAgreeNumber %&gt;票，弃权&lt;%=abondonNumber %&gt;票!&lt;/span&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/s:if&gt;</span><br><span class="line">&lt;s:<span class="keyword">else</span>&gt;</span><br><span class="line">	&lt;div id=<span class="string">"js"</span> align=<span class="string">"center"</span> style=<span class="string">"position:fixed;bottom:0px;display:none; width:auto;color: red;text-align: center;  height:15px; padding-top:8px; padding-bottom: 8px; font-size:13px;  margin: auto; "</span>&gt;	</span><br><span class="line">		&lt;span&gt;您的投票结果为：同意&lt;%=agreeNumber%&gt;票，不同意&lt;%=disAgreeNumber %&gt;票，弃权&lt;%=abondonNumber %&gt;票!&lt;/span&gt;</span><br><span class="line">	&lt;/div&gt;</span><br><span class="line">	</span><br><span class="line">&lt;/s:else&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/s:form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">    &lt;div id=<span class="string">"displaydiv"</span> &gt;</span><br><span class="line">        &lt;div style=<span class="string">"text-align:left;"</span>&gt;</span><br><span class="line">            &lt;form id=<span class="string">"myForm"</span> action=<span class="string">"AppMaterialAction!getMaterialsByCommitConfer.action"</span>  method=<span class="string">"post"</span>&gt;</span><br><span class="line">                &lt;s:checkboxlist name=<span class="string">"configValue"</span> list=<span class="string">"#cdmanager.setAllColumn()"</span> listKey=<span class="string">"enname"</span> listValue=<span class="string">"cnname"</span> value=<span class="string">"#cdmanager.getDisplayString()"</span> /&gt;</span><br><span class="line">                &lt;br/&gt;&lt;s:hidden name="conferId" value="%&#123;conferId&#125;"&gt;&lt;/s:hidden&gt;</span><br><span class="line">                &lt;s:submit value="设置"&gt;&lt;/s:submit&gt;</span><br><span class="line">                &lt;input type=<span class="string">"button"</span> id=<span class="string">"btnHide"</span> name=<span class="string">"buttonName"</span> value=<span class="string">"取消"</span>/&gt;</span><br><span class="line">            &lt;/form&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/s:bean&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;script&gt; </span><br><span class="line">	var oPopup;</span><br><span class="line">	var popTop;</span><br><span class="line">	<span class="comment">//全局结果变量，map对象，最后提交表单的时候转化为json提交，建map.js</span></span><br><span class="line">	<span class="comment">//没有设maxAgree的时候，则maxAgree取10000</span></span><br><span class="line">	var resultMap; </span><br><span class="line">	var maxAgree = &lt;%=maxAgree%&gt;;</span><br><span class="line">	<span class="keyword">if</span>(maxAgree == <span class="number">0</span>)</span><br><span class="line">		maxAgree = <span class="number">10000</span>;</span><br><span class="line">	</span><br><span class="line"><span class="comment">/* 	window.onload=function()&#123;</span></span><br><span class="line"><span class="comment">		//dwr.engine.setActiveReverseAjax(true);</span></span><br><span class="line"><span class="comment">		//resultMapInit();//初始化全局变量resultmap</span></span><br><span class="line"><span class="comment">	&#125;; */</span></span><br><span class="line">	</span><br><span class="line">	<span class="function">function <span class="title">popmsg</span><span class="params">(msgstr)</span></span>&#123;</span><br><span class="line">		oPopup = window.createPopup();</span><br><span class="line">		popTop=<span class="number">25</span></span><br><span class="line">		var winstr=<span class="string">""</span>;</span><br><span class="line">		</span><br><span class="line">		winstr+=<span class="string">""</span>;</span><br><span class="line">		winstr+=<span class="string">"&lt;h2 style=\"background:#87CEFA;font-size:12px; margin:0;\"&gt;专家提醒&lt;/h2&gt;"</span>;</span><br><span class="line">		winstr+=<span class="string">"&lt;h2 style=\"text-align:center; color:red;font-size:12px;border:0px; border-color:white;line-height:20px;width:auto;height:200px;margin:0;padding:40px 10px 10px 10px;background:#F5F5F5;\"&gt;"</span>+msgstr+<span class="string">"&lt;/h2&gt;"</span></span><br><span class="line">		</span><br><span class="line">		oPopup.document.body.innerHTML = winstr;</span><br><span class="line">		popshow();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function">function <span class="title">popshow</span><span class="params">()</span></span>&#123;</span><br><span class="line">		window.status=popTop;</span><br><span class="line">		<span class="keyword">if</span>(popTop&gt;<span class="number">860</span>)&#123;</span><br><span class="line">			clearTimeout(mytime);</span><br><span class="line">			oPopup.hide();</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span> <span class="keyword">if</span>(popTop&gt;<span class="number">760</span>&amp;&amp;popTop&lt;<span class="number">860</span>)&#123;</span><br><span class="line">			oPopup.show(screen.width-<span class="number">250</span>,screen.height,<span class="number">241</span>, <span class="number">860</span>-popTop);</span><br><span class="line">		&#125;<span class="keyword">else</span> <span class="keyword">if</span>(popTop&lt;<span class="number">90</span>)&#123;</span><br><span class="line">			oPopup.show(screen.width-<span class="number">250</span>,screen.height,<span class="number">241</span>, popTop);</span><br><span class="line">		&#125;<span class="keyword">else</span> <span class="keyword">if</span>(popTop&lt;<span class="number">110</span>)&#123;</span><br><span class="line">			oPopup.show(screen.width-<span class="number">250</span>,screen.height-popTop,<span class="number">241</span>, popTop);</span><br><span class="line">		&#125;</span><br><span class="line">		popTop+=<span class="number">5</span>;</span><br><span class="line">		var mytime=setTimeout(<span class="string">"popshow();"</span>,<span class="number">50</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function">function <span class="title">saveResult</span><span class="params">(applyId, result, index)</span></span>&#123;</span><br><span class="line">		var max = <span class="keyword">false</span>;</span><br><span class="line">		<span class="keyword">if</span>(result == <span class="string">"agree"</span>)&#123;	<span class="comment">//首先检查同意人数是否达到了上限</span></span><br><span class="line">			<span class="keyword">if</span>(resultMap.getNum(result) &gt;= maxAgree)&#123;</span><br><span class="line">				var warning = <span class="string">"同意人数不能超过"</span> + maxAgree + <span class="string">"名!"</span>;</span><br><span class="line">				alert(warning);</span><br><span class="line">				var result = <span class="string">"abondon"</span>;</span><br><span class="line">				<span class="keyword">if</span>(resultMap.containsKey(applyId))&#123;</span><br><span class="line">					result = resultMap.get(applyId);</span><br><span class="line">				&#125;</span><br><span class="line">				var radio = document.getElementsByName(<span class="string">"radio"</span> + index);</span><br><span class="line">				<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;radio.length; i++)&#123;</span><br><span class="line">					radio[i].checked = <span class="keyword">false</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span>(result == <span class="string">"disagree"</span>)&#123;</span><br><span class="line">					radio[<span class="number">1</span>].checked = <span class="keyword">true</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span></span><br><span class="line">					radio[<span class="number">2</span>].checked = <span class="keyword">true</span>;</span><br><span class="line">				max = <span class="keyword">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(!max)&#123;</span><br><span class="line">			<span class="keyword">if</span>(resultMap.containsKey(applyId))&#123;</span><br><span class="line">				resultMap.remove(applyId);</span><br><span class="line">				resultMap.put(applyId, result);</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				resultMap.put(applyId, result);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		var appLength = document.getElementById(<span class="string">"listLength"</span>).value;</span><br><span class="line">		var agreeNum = resultMap.getNum(<span class="string">"agree"</span>) + <span class="string">""</span>;</span><br><span class="line">		var disagreeNum = resultMap.getNum(<span class="string">"disagree"</span>);</span><br><span class="line">		var abondonNum = resultMap.getNum(<span class="string">"abondon"</span>);</span><br><span class="line">		var surplus = maxAgree - agreeNum;</span><br><span class="line">		var remain = appLength - agreeNum - disagreeNum - abondonNum;</span><br><span class="line">		var content = <span class="string">"&lt;span&gt;您的投票结果为：同意"</span> + agreeNum + <span class="string">"票，不同意"</span> + disagreeNum + <span class="string">"票，弃权"</span> + abondonNum + <span class="string">"票！&lt;/span&gt;"</span>;</span><br><span class="line">		document.getElementById(<span class="string">"js"</span>).innerHTML = content;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function">function <span class="title">checkAllSubmit</span><span class="params">()</span></span>&#123;</span><br><span class="line">		</span><br><span class="line">		var appLength = document.getElementById(<span class="string">"listLength"</span>).value;</span><br><span class="line">		var surplus = appLength-resultMap.size();</span><br><span class="line">		<span class="comment">//alert(1);</span></span><br><span class="line">		<span class="keyword">if</span>(surplus &gt; <span class="number">0</span>)&#123;</span><br><span class="line">			alert(<span class="string">"您还有"</span> + surplus + <span class="string">"个申请人没有进行投票！"</span>);</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span> <span class="keyword">if</span>(surplus == <span class="number">0</span>)&#123;</span><br><span class="line">			var resultStr = resultMap.getString();</span><br><span class="line">			document.getElementById(<span class="string">"result"</span>).value = resultStr;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		var agreeNum = resultMap.getNum(<span class="string">"agree"</span>);</span><br><span class="line">		var disagreeNum = resultMap.getNum(<span class="string">"disagree"</span>);</span><br><span class="line">		var abondonNum = resultMap.getNum(<span class="string">"abondon"</span>);</span><br><span class="line">		var note = <span class="string">'您的投票结果为：同意'</span>+ agreeNum +<span class="string">'票，不同意'</span>+ disagreeNum +<span class="string">'票，弃权'</span>+ abondonNum +<span class="string">'票!\n'</span>;</span><br><span class="line">		</span><br><span class="line">		var c = confirm(note+<span class="string">'确定要提交吗？'</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(c == <span class="keyword">false</span>)&#123;</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//$('#btnSubmit').attr('disabled','disabled');</span></span><br><span class="line">			<span class="comment">//alert(resultStr);</span></span><br><span class="line">			<span class="comment">//btnSubmit = $('#btnSubmit');</span></span><br><span class="line">			<span class="comment">//btnSubmit.attr("disabled",false);</span></span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		setTimeout(function()&#123;$(<span class="string">'#btnSubmit'</span>).attr(<span class="string">'disabled'</span>,<span class="string">'disabled'</span>);&#125;,<span class="number">0</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function">function <span class="title">preventCheck</span><span class="params">()</span></span>&#123;	<span class="comment">//已经提交过，不允许再点击</span></span><br><span class="line">		alert(<span class="string">"您已经投过票了，不允许再投！"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function">function <span class="title">printCheck</span><span class="params">()</span></span>&#123;		<span class="comment">//提交之前先打印</span></span><br><span class="line">		window.open(<span class="string">"CommitStatsAction!print.action?idenCode=&lt;%=idenCode%&gt;&amp;commConId=&lt;%=conferId%&gt;"</span>, <span class="string">"_blank"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function">function <span class="title">showMessage</span><span class="params">(msg)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">	    <span class="comment">//alert(msg);</span></span><br><span class="line">		var conferId = &lt;%=conferId%&gt;;</span><br><span class="line">		<span class="comment">//popmsg2(msg);</span></span><br><span class="line">		<span class="keyword">if</span>(conferId == msg)&#123;</span><br><span class="line">			popmsg(<span class="string">"刷新后可以开始投票！"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//在可以投票的时候调用一次，覆盖右侧结果，初始化resultMap为</span></span><br><span class="line">	<span class="function">function <span class="title">initResult</span><span class="params">()</span></span>&#123;</span><br><span class="line">		dwr.engine.setActiveReverseAjax(<span class="keyword">true</span>);</span><br><span class="line">		resultMap = <span class="keyword">new</span> Map();<span class="comment">//自定义数据结构 ，见map.js</span></span><br><span class="line">		var appLength = document.getElementById(<span class="string">"listLength"</span>).value;</span><br><span class="line">		<span class="keyword">for</span>(var i=<span class="number">0</span>; i&lt;appLength; i++)&#123;</span><br><span class="line">			var applyIdFlag = <span class="string">"applyId"</span> + i;</span><br><span class="line">			var curApplyId = document.getElementById(applyIdFlag).value;</span><br><span class="line">			<span class="comment">//resultMap.clear();</span></span><br><span class="line">			</span><br><span class="line">			var defaultAgree = &lt;%=defaultAgree%&gt;;</span><br><span class="line">			<span class="keyword">if</span>(defaultAgree == <span class="number">1</span>)&#123;</span><br><span class="line">				resultMap.put(curApplyId, <span class="string">"agree"</span>);</span><br><span class="line">				<span class="comment">//console.log("1");</span></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span>&#123;</span><br><span class="line">				resultMap.put(curApplyId, <span class="string">"abondon"</span>);</span><br><span class="line">				<span class="comment">//console.log("0");</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"><span class="comment">/* 		var appLength = document.getElementById("listLength").value;</span></span><br><span class="line"><span class="comment">		var agreeNum = resultMap.getNum("agree") + "";</span></span><br><span class="line"><span class="comment">		var disagreeNum = resultMap.getNum("disagree");</span></span><br><span class="line"><span class="comment">		var abondonNum = resultMap.getNum("abondon");</span></span><br><span class="line"><span class="comment">		var content = "您的投票结果为：同意" + agreeNum + "票，不同意" + disagreeNum + "票，弃权" + abondonNum + "票！";</span></span><br><span class="line"><span class="comment">		console.log(content);</span></span><br><span class="line"><span class="comment">		document.getElementById("js").innerHTML = content; */</span></span><br><span class="line">		displayLeftSpare();<span class="comment">//右边结果变化,现在改成了下面</span></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//右侧结果变化，现在改成下面</span></span><br><span class="line">	<span class="function">function <span class="title">displayLeftSpare</span><span class="params">()</span></span>&#123;</span><br><span class="line">		var appLength = document.getElementById(<span class="string">"listLength"</span>).value;</span><br><span class="line">		var agreeNum = resultMap.getNum(<span class="string">"agree"</span>) + <span class="string">""</span>;</span><br><span class="line">		</span><br><span class="line">		var disagreeNum = resultMap.getNum(<span class="string">"disagree"</span>);</span><br><span class="line">		var abondonNum = resultMap.getNum(<span class="string">"abondon"</span>);</span><br><span class="line">		var content = <span class="string">"您的投票结果为：同意"</span> + agreeNum + <span class="string">"票，不同意"</span> + disagreeNum + <span class="string">"票，弃权"</span> + abondonNum + <span class="string">"票！"</span>;</span><br><span class="line">		<span class="comment">//console.log(content);</span></span><br><span class="line">		document.getElementById(<span class="string">"js"</span>).innerHTML = content;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//没用到</span></span><br><span class="line">	<span class="function">function <span class="title">setHeight</span><span class="params">()</span></span>&#123;</span><br><span class="line">		var h = $(document).height();</span><br><span class="line">		$(<span class="string">'#showMate'</span>).css(<span class="string">'max-height'</span>, h-<span class="number">90</span>);</span><br><span class="line">		$(<span class="string">'#mainbox'</span>).css(<span class="string">'max-height'</span>, h);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function">function <span class="title">sendMessage</span><span class="params">()</span></span>&#123;</span><br><span class="line">		$.ajax(&#123;</span><br><span class="line">		    url : <span class="string">"Message.jsp"</span>,<span class="comment">// 后台处理程序</span></span><br><span class="line">		    dataType : <span class="string">"text"</span>,<span class="comment">// 接受数据格式</span></span><br><span class="line">		    cache: <span class="keyword">false</span>,<span class="comment">//禁用缓存</span></span><br><span class="line">		    <span class="comment">// 回传函数</span></span><br><span class="line">		    success : function(responsedata) &#123;</span><br><span class="line">		        <span class="keyword">if</span>(responsedata==<span class="string">'0'</span>)&#123;</span><br><span class="line">		        	<span class="comment">//popmsg("刷新后可以开始投票！");</span></span><br><span class="line">		        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(responsedata==<span class="string">'1'</span>)&#123;</span><br><span class="line">		            <span class="comment">//alert("1");</span></span><br><span class="line">		        	popmsg(<span class="string">"刷新后可以开始投票！"</span>);</span><br><span class="line">		        &#125;</span><br><span class="line">		    &#125;</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	<span class="function">function <span class="title">rebalanceTable</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="comment">//调整窗口大小的时候，根据内容table的表格比例，调整表头table的表格比例</span></span><br><span class="line">		var mytablefl=$(<span class="string">"#mytable&gt;tbody&gt;tr:eq(0)"</span>);</span><br><span class="line">		<span class="comment">//console.log($(mytablefl).html());	</span></span><br><span class="line">		var myhead=$(<span class="string">"#headtable&gt;thead&gt;tr:eq(0)"</span>);</span><br><span class="line">		<span class="keyword">for</span>(var i=<span class="number">0</span>; i&lt;<span class="number">6</span>; i++)&#123;</span><br><span class="line">			var width=$(mytablefl).children(<span class="string">"td"</span>).eq(i).css(<span class="string">"width"</span>);</span><br><span class="line">			<span class="comment">//console.log(width);</span></span><br><span class="line">			$(myhead).children(<span class="string">"th"</span>).eq(i).css(<span class="string">"width"</span>,width);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(var i=<span class="number">6</span>; i&lt;<span class="number">11</span>;i++)&#123;</span><br><span class="line">			var width=$(mytablefl).children(<span class="string">"td"</span>).eq(i).css(<span class="string">"width"</span>);</span><br><span class="line">			$(<span class="string">"#grtable&gt;tr:eq(1)&gt;td"</span>).eq(i-<span class="number">6</span>).css(<span class="string">"width"</span>,width);	</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//var scrollWidth=getScrollWidth();</span></span><br><span class="line">		<span class="comment">//console.log(scrollWidth+"px");</span></span><br><span class="line">		<span class="comment">//$(myhead).children("th").eq(7).css("width",scrollWidth+"px");</span></span><br><span class="line">		<span class="comment">//调整内容表格的位置，对齐</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">//先调整宽度</span></span><br><span class="line">		var tabwidth= parseInt($(<span class="string">"#divtab"</span>).css(<span class="string">"width"</span>));</span><br><span class="line">		console.log(tabwidth);</span><br><span class="line">		$(<span class="string">"#divheadtable"</span>).css(<span class="string">"width"</span>,tabwidth-getScrollWidth()+<span class="string">"px"</span>);</span><br><span class="line">		<span class="comment">//再调整宽度</span></span><br><span class="line">		var height=$(<span class="string">"#divheadtable"</span>).css(<span class="string">"height"</span>);</span><br><span class="line">		console.log(parseInt(height));</span><br><span class="line">		$(<span class="string">"#divtab"</span>).css(<span class="string">"top"</span>,<span class="number">60</span>+parseInt(height));		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	$(<span class="string">"#spinner"</span>).css(<span class="string">'display'</span>,<span class="string">'none'</span>);</span><br><span class="line">	$(<span class="string">"#divheadtable"</span>).css(<span class="string">'display'</span>,<span class="string">'block'</span>);</span><br><span class="line">	$(<span class="string">"#divtab"</span>).css(<span class="string">'display'</span>,<span class="string">'block'</span>);</span><br><span class="line">	$(<span class="string">"#nav"</span>).css(<span class="string">'display'</span>,<span class="string">'block'</span>);</span><br><span class="line">	rebalanceTable();<span class="comment">//调整表格比例</span></span><br><span class="line">	$(<span class="string">"#js"</span>).css(<span class="string">'display'</span>,<span class="string">'block'</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//点击了修改默认结果</span></span><br><span class="line">	<span class="function">function <span class="title">clickSel_Btn</span><span class="params">()</span></span>&#123;</span><br><span class="line">		var value=$(<span class="string">"#defaultSelect&gt;option:selected"</span>).val();</span><br><span class="line">		<span class="comment">//console.log(value);</span></span><br><span class="line">		<span class="keyword">if</span>(value==<span class="number">1</span>)&#123; <span class="comment">//加载学科组结果</span></span><br><span class="line">			var newResultMap=<span class="keyword">new</span> Map();</span><br><span class="line">			$(<span class="string">"#mytable&gt;tbody&gt;tr"</span>).each(function()&#123;</span><br><span class="line">				var totalNum=$(<span class="keyword">this</span>).children(<span class="string">"td"</span>).eq(<span class="number">7</span>).text();</span><br><span class="line">				var agreeNum=$(<span class="keyword">this</span>).children(<span class="string">"td"</span>).eq(<span class="number">8</span>).text();</span><br><span class="line">				var disagreeNum=$(<span class="keyword">this</span>).children(<span class="string">"td"</span>).eq(<span class="number">9</span>).text();</span><br><span class="line">				var abondonNum=$(<span class="keyword">this</span>).children(<span class="string">"td"</span>).eq(<span class="number">10</span>).text();</span><br><span class="line">				<span class="comment">//console.log(totalNum +" " +agreeNum + " "+disagreeNum +" "+abondonNum);</span></span><br><span class="line">				var passRate =agreeNum/totalNum;</span><br><span class="line">				var unpassRate= disagreeNum/totalNum;</span><br><span class="line">				var applyId= $(<span class="keyword">this</span>).children(<span class="string">"input[type=hidden]"</span>).val();</span><br><span class="line">				var result=<span class="string">"disagree"</span>;</span><br><span class="line">				<span class="keyword">if</span>(passRate&gt;unpassRate&amp;&amp;passRate&gt;=(<span class="number">2</span>/<span class="number">3</span>))&#123;</span><br><span class="line">					result=<span class="string">"agree"</span></span><br><span class="line">				&#125;</span><br><span class="line">				<span class="comment">//console.log(applyId+" "+result);</span></span><br><span class="line">			    newResultMap.put(applyId, result);</span><br><span class="line">				</span><br><span class="line">			&#125;);</span><br><span class="line">			<span class="keyword">if</span>(newResultMap.getNum(<span class="string">"agree"</span>)&gt;maxAgree)&#123;</span><br><span class="line">				<span class="comment">//console.log("同意人数："+newResultMap.getNum("agree")+" "+newResultMap.getNum("disagree"));</span></span><br><span class="line">				alert(<span class="string">"同意人数不能超过"</span> + maxAgree + <span class="string">"名!，无法设定,请手动投票"</span>);</span><br><span class="line">				<span class="keyword">return</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		 	resultMap=newResultMap;</span><br><span class="line">		 	$(<span class="string">"#mytable&gt;tbody&gt;tr"</span>).each(function()&#123;</span><br><span class="line">		 		var applyId= $(<span class="keyword">this</span>).children(<span class="string">"input[type=hidden]"</span>).val();</span><br><span class="line">		 		var res=resultMap.get(applyId);</span><br><span class="line">		 		<span class="comment">//console.log(res);</span></span><br><span class="line">		 		$(<span class="keyword">this</span>).children(<span class="string">"td"</span>).eq(<span class="number">0</span>).children(<span class="string">"input[type=radio][value="</span>+resultMap.get(applyId)+<span class="string">"]"</span>).attr(<span class="string">"checked"</span>,<span class="string">"checked"</span>);</span><br><span class="line">		 	&#125;);</span><br><span class="line">		 	alert(<span class="string">"将默认投票选项设定为：学科组投票结果,成功！"</span>);</span><br><span class="line">			<span class="comment">//displayLeftSpace();</span></span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span>(value==<span class="number">2</span>)&#123; <span class="comment">//同意</span></span><br><span class="line">			<span class="keyword">if</span>(resultMap.size()&gt;maxAgree)&#123;</span><br><span class="line">				alert(<span class="string">"同意人数不能超过"</span> + maxAgree + <span class="string">"名!，无法设定,请手动投票"</span>);</span><br><span class="line">				<span class="keyword">return</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">for</span>(var i=<span class="number">0</span>; i&lt;resultMap.size(); i++)&#123;</span><br><span class="line">				resultMap.elements[i].value=<span class="string">"agree"</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		    $(<span class="string">"input[type=radio][value=agree]"</span>).attr(<span class="string">"checked"</span>,<span class="string">"checked"</span>);</span><br><span class="line">		    alert(<span class="string">"将默认投票选项设定为：同意,成功！"</span>);</span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span>(value==<span class="number">3</span>)&#123; <span class="comment">//不同意</span></span><br><span class="line">			<span class="keyword">for</span>(var i=<span class="number">0</span>; i&lt;resultMap.size(); i++)&#123;</span><br><span class="line">				resultMap.elements[i].value=<span class="string">"disagree"</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			$(<span class="string">"input[type=radio][value=disagree]"</span>).attr(<span class="string">"checked"</span>,<span class="string">"checked"</span>);</span><br><span class="line">			 alert(<span class="string">"将默认投票选项设定为：不同意,成功！"</span>);</span><br><span class="line">		&#125; <span class="keyword">else</span>&#123; <span class="comment">//放弃</span></span><br><span class="line">			<span class="keyword">for</span>(var i=<span class="number">0</span>; i&lt;resultMap.size(); i++)&#123;</span><br><span class="line">				resultMap.elements[i].value=<span class="string">"abondon"</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			$(<span class="string">"input[type=radio][value=abondon]"</span>).attr(<span class="string">"checked"</span>,<span class="string">"checked"</span>);</span><br><span class="line">			alert(<span class="string">"将默认投票选项设定为：放弃,成功！"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		displayLeftSpare();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//调整窗口大小的时候，要调整一下表格</span></span><br><span class="line">	window.onresize = function()&#123;</span><br><span class="line">		<span class="comment">//console.log("resize");</span></span><br><span class="line">		rebalanceTable();</span><br><span class="line">	&#125;;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//防止投票时间过长，没3分钟发送无意义请求一个。</span></span><br><span class="line">	setInterval(function()&#123;</span><br><span class="line">		$.ajax(&#123;</span><br><span class="line">		    url : <span class="string">"keepAliveServiceByAjax.service"</span>,<span class="comment">// 后台处理程序</span></span><br><span class="line">		    dataType : <span class="string">"json"</span>,<span class="comment">// 接受数据格式</span></span><br><span class="line">		    cache: <span class="keyword">false</span>,<span class="comment">//禁用缓存</span></span><br><span class="line">		    <span class="comment">// 回传函数</span></span><br><span class="line">		    success : function(responsedata) &#123;</span><br><span class="line">		        <span class="keyword">if</span>(responsedata==<span class="number">1</span>)&#123;</span><br><span class="line">		        	console.log(<span class="string">"keepalive,per3min"</span>);</span><br><span class="line">		        &#125;</span><br><span class="line">		    &#125;</span><br><span class="line">		&#125;);</span><br><span class="line">		</span><br><span class="line">	&#125;,<span class="number">60000</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//获取滚动条宽度</span></span><br><span class="line">	<span class="function">function <span class="title">getScrollWidth</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">		  var noScroll, scroll, oDiv = document.createElement(<span class="string">"DIV"</span>);  </span><br><span class="line">		  oDiv.style.cssText = <span class="string">"position:absolute; top:-1000px; width:100px; height:100px; overflow:hidden;"</span>;  </span><br><span class="line">		  noScroll = document.body.appendChild(oDiv).clientWidth;  </span><br><span class="line">		  oDiv.style.overflowY = <span class="string">"scroll"</span>;  </span><br><span class="line">		  scroll = oDiv.clientWidth;  </span><br><span class="line">		  document.body.removeChild(oDiv);  </span><br><span class="line">		  <span class="keyword">return</span> noScroll-scroll;  </span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//为了好看，设置了内容div最小宽度上，设置了最小宽度。 </span></span><br><span class="line">	<span class="comment">//同步滚动条</span></span><br><span class="line">	$(<span class="string">'#divtab'</span>).scroll( function() &#123; </span><br><span class="line">		<span class="comment">//$('#divheadtable').scrollTop($(this).scrollTop()); </span></span><br><span class="line">		$(<span class="string">'#divheadtable'</span>).scrollLeft($(<span class="keyword">this</span>).scrollLeft()); </span><br><span class="line">	&#125;); </span><br><span class="line">	</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<p><strong>查询表格内容的实现</strong></p>
<blockquote>
<p>首先在action中根据用户idenCode验证码，和conferId以及当前会议的round查询出所有的材料<br><br>通过zcps_materials与zcps_group_result连接<br><br>用conferId查询出会议信息。<br><br>查询该许可码用户是否已经投过票了，表该会议里该轮，表有票就是投过票了.<br><br>会议状态：会议开始，会议挂起，开始投票，会议结束<br><br>对该用户会议状态分为： 会议开始阶段（[等于会议挂起状态]不允许投票）0，投票是开始阶段1，该用户投票结束2<br><br>如果开启第二轮投票将会有这个最大同意的上限。<br>查询出 某次会议，某许可证idenCode，某论的投票 的评审结果(看是否已经投票过了，投过了显示结果。)<br><br>显示的每一分材料的主要思路，就是查询出当前会议的所有需要评审的材料<br>查询出当前idenCode的当前confer当前round轮的结果<br>如果没有投过票，那就根据会议状态显示 不能投票，或者开始投票的状态。<br>如果投过票，那就直接显示投票的结果。</p>
</blockquote>
<blockquote>
<p>表单的提交，选择的结果存储在js的一个全局变量中resultMap中，是一个根据js数组实现的类java的map。提交表单的时候，会转化为json，然后提交。<br><strong>设定默认投票结果</strong><br>默认投票的有个最大的同意上限，maxAgree 在不开启第二轮投票的时候，默认投票数目为100000很大，<br>开启第二轮投票的时候设定。<br>默认同意，在设定maxAgree的时候，一般 人数&gt;maxAgree 无法设定。</p>
</blockquote>
<p><strong>固定表头的实现</strong><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">table</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">table</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>困难：<br>1.表头和表内容分离后，两者的比例不协调。巨难看。<br><br>2.表头高度更具浏览器窗口的大小变化，因此不好直接定位。表内容想根据窗口大小，div的下边框定位到最下面，填满整个窗口。<br><br>3.还有一个很烦的东西，就是内容table会出现右侧滚动条。滚动条是占空间。</p>
</blockquote>
<blockquote>
<p>实现原理：两个div都设置为fixed布局，div设定大小为99%.<br>生成连个表格之后，根据内容表格的表格每一列宽度设置，内容表格的宽度。div-滚动条的宽度=表格的宽度<br>，然后设置表头表格宽度。表头表格设置宽度后，会自动调整其自身高度。然后根据表头高度设置第二个表格的top位置。同时为了好看设定了两个table的min-width：所有会出现滚动条，隐藏表头的滚动条，然后上下同步滚动条就行了。</p>
</blockquote>
<h3 id="拦截器修改-error-jsp"><a href="#拦截器修改-error-jsp" class="headerlink" title="拦截器修改  error.jsp"></a>拦截器修改  error.jsp</h3><p>/AdminAction!Logout.action 退出不用拦截</p>
<h3 id="发现的问题"><a href="#发现的问题" class="headerlink" title="发现的问题"></a>发现的问题</h3><p>所有查询结果都巨慢，特别是手动计票的时候，巨慢。（真心巨慢啊）<br><img src="images/日志1.png"></p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/blog/" rel="tag"># blog</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/10/07/基于Hexo的博客系统/" rel="next" title="基于Hexo的博客系统">
                <i class="fa fa-chevron-left"></i> 基于Hexo的博客系统
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/uploads/avatar.png"
                alt="Sidewinder_AK47" />
            
              <p class="site-author-name" itemprop="name">Sidewinder_AK47</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/SidewinderAK47" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:yourname@gmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://twitter.com/yourname" target="_blank" title="Twitter">
                      
                        <i class="fa fa-fw fa-twitter"></i>Twitter</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://instagram.com/yourname" target="_blank" title="Instagram">
                      
                        <i class="fa fa-fw fa-instagram"></i>Instagram</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#职称系统修改笔记"><span class="nav-number">1.</span> <span class="nav-text">职称系统修改笔记</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2019年4月4日"><span class="nav-number">1.1.</span> <span class="nav-text">2019年4月4日</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#评审结果管理：添加全部删除当年度的所有评审结果功能-2019年4月4日"><span class="nav-number">1.1.1.</span> <span class="nav-text">评审结果管理：添加全部删除当年度的所有评审结果功能 2019年4月4日</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-修复了【评审结果管理】，查询年度翻页的问题-2019年4月4日"><span class="nav-number">1.1.2.</span> <span class="nav-text">2 修复了【评审结果管理】，查询年度翻页的问题  2019年4月4日</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#【评议组设置】存在的问题—2019年4月4日"><span class="nav-number">1.1.3.</span> <span class="nav-text">【评议组设置】存在的问题—2019年4月4日</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#修改生成许可代码的代码-2019年4月4日19-24-18"><span class="nav-number">1.1.4.</span> <span class="nav-text">修改生成许可代码的代码 2019年4月4日19:24:18</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#申报资料审核-未通过材料-修改到-未审材料"><span class="nav-number">1.1.5.</span> <span class="nav-text">申报资料审核  未通过材料 修改到   未审材料</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#投票页面的修改-【大修改】-2019年4月4日"><span class="nav-number">1.1.6.</span> <span class="nav-text">投票页面的修改 【大修改】 2019年4月4日</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#拦截器修改-error-jsp"><span class="nav-number">1.1.7.</span> <span class="nav-text">拦截器修改  error.jsp</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#发现的问题"><span class="nav-number">1.1.8.</span> <span class="nav-text">发现的问题</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2018 &mdash; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Sidewinder_AK47</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  

    
      <script id="dsq-count-scr" src="https://SidewinderAK47.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'http://yoursite.com/2019/04/05/修改笔记/';
          this.page.identifier = '2019/04/05/修改笔记/';
          this.page.title = '职称系统修改笔记';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://SidewinderAK47.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  




	





  














  





  

  

  

  
  

  

  

  

</body>
</html>
